---
title:  "R Worksheet 5: Plots II: Making plots better"
author: "MATH1710 Probability and Statistcs I"
date:   "University of Leeds, 2021--22"
output: html_document
---

*This R worksheet* does *include assessed questions at the bottom. Only the question marked "Assessed Question" are assessed, not the other "Exercises". The deadline for submitting your solutions to these questions is **Monday 1 November at 1400**. If you have difficulty with this worksheet, you can get help at the office hours drop-on sessions.*

------------------------------------------------------------------------

On the last R worksheet, we saw the basic commands for plotting data visualisations:

* `boxplot()` for boxplots,
* `hist()` for histograms,
* `plot()` for scatterplots.

We also saw some optional arguments these functions could take, to change the appearance of the plot:

* the `breaks = ...` argument to specify the number or sizes of bins in a histogram;
* the `type = ...` argument to draw points, lines, or both in a scatterplot.

In this worksheet, we will see a number of other optional arguments that can be used to improve the appearance of your plots. Many of these arguments can be applied to any of the three plot types we've studied.

## Labelling and titling

When drawing a plot, it's very important that it's clear what the data represents. To do this, we almost always need to label the x and y axes. It's often helpful to give to give the plot an explanatory title. Axis label are set with the arguments **`xlab = ...`** and **`ylab = ...`** respectively. A title is set with **`main = ...`**. The text to appear in the labels/title must always be put in quotation marks `" "`. Remember that multiple arguments must be separated by commas.

Let's use the Met Office historical temperature data again.

```{r}
temperature <- read.csv("https://mpaldridge.github.io/math1710/data/met-office.csv")
```

In the last worksheet, we drew a histogram of December temperatures with the command

```{r}
hist(temperature$dec, freq = FALSE)
```

But this picture would be clearer properly labelled and titled.

```{r}
hist(temperature$dec, freq = FALSE, xlab = "Average temperature (degrees Celsius)", ylab = "Probability densitiy", main = "Historical December temperatures in the UK")
```

Adding all these extra arguments can make your code difficult to read. Remember that R allows you to use line breaks when it's obvious a command isn't finished -- for example, when a pair of brackets has been opened but not yet closed. You can also add spaces to make your code easier to read. For example, you may find the following format of exactly the same command as above more pleasant.

```{r, eval = FALSE}
hist(temperature$dec, freq = FALSE,
  xlab = "Average temperature (degrees Celsius)",
  ylab = "Probability densitiy",
  main = "Historical December temperatures in the UK"
)
```

> **Exercise 5.1.** Last time, in Exercise 4.5, you drew a scatterplot of January and August temperatures. Do this again, but with explanatory labels on the axes and an explanatory title. (Don't forget to make sure you've read the temperature data in first.)

For boxplots diagrams with multiple boxplots, you will also want to label the individual boxplots. This is done with the **`names = ...`** arguments to `boxplot()`. Here, `names` should be equal to a vector of the names given to the boxplots. Remember that vectors are set with `c()`, and each of the names must be in quotation marks.

Adapting another example from last time, we get

```{r}
boxplot(temperature$jul, temperature$aug, temperature$sep,
  xlab  = "Month",
  names = c("July", "August", "September"),
  ylab  = "Average temperature (degrees Celsius)",
  main  = "Historical UK temperatures"
)
```

## Axis limits

When you draw a plot, R tries to chosen the upper and lower limits of the x and y axes sensibly, to ensure that all the data fits, and that the numbers shown on the axes can be reasonably round numbers. (For histograms, R also ensures the lower limit on the y-axis is 0.) However, sometimes, you may wish to choose the axis limits yourself. The main reason we might to fix the axis limits ourselves, is that in some circumstances, it's appropriate to let the y-axis start at 0, to put changes in the corresponding value in proper context. (R may choose to zoom in on relatively unimportant small changes.)

We can choose the axes limits ourselves using the **`xlim = ...`** and **`ylim = ...`** arguments. Here `xlim` or `ylim` should be set to be a vector of length 2, with the first number being the lower limit for the axis and the second number being the upper limit.]

For example, if making a scatterplot of February and July temperatures, I may wan to put both month's temperatures on the same scale -- say from -2 to 10 -- to give a fair comparison between them.

```{r}
plot(temperature$feb, temperature$apr,
  xlab = "Average February temperature (degrees Celsius)",
  ylab = "Average April temperature (degrees Celsius)",
  xlim = c(-2, 10),
  ylim = c(-2, 10)
)
```

COLOURS
ABLINE

ASSESSED:
HEIGHT OF BOXPLOT
SPREAD OF BOXPLOT
OUTLIER IN BOXPLOT
NUMBER OF PEAKS IN HISTOGRAM
CORRELATION IN SCATTERPLOT

---

## Assessed questions

*The following fice assessed questions should be submitted to the Microsoft Form that is linked to on the Minerva page for this module. I recommend you do this in Week 3, but the official deadline is **Monday 18 October at 1400**.*

*This worked will be marked automatically by computer, so make sure you answers are accurate -- the computer does not "know what you meant"; only what you actually enter into the form.*

*So that (most) students get different data to work with, you will work from a data file whose name is based on your student ID number. You student ID number is (usually) a 9-digit number starting `201`. Your data set is the CSV file at*

```
https://mpaldridge.github.io/math1710/data/R5-xy.csv
```

*where `xy` is replaced by the last two digits of your student ID number. So if your student ID is `201623429`, then you should use the file at `https://mpaldridge.github.io/math1710/data/R5-29.csv`; if your student ID number is `201491200` then you should use the file `https://mpaldridge.github.io/math1710/data/R5-00.csv` and so on. Take care to check you get this correct: if you get your student ID number wrong and/or use the wrong data file, the computer is likely to award you 0 marks.*

---

dfgdfg