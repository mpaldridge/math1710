--- 
title: "MATH1710 Probability and Statistics I"
author: "[Matthew Aldridge](https://mpaldridge.github.io/)"
date: "University of Leeds, 2023--24"
site: bookdown::bookdown_site
documentclass: book
description: "Lecture notes for the course MATH1710 Probability and Statistics I at the University of Leeds, 2023--2025"
favicon: favicon.ico
url:    'https://mpaldridge.github.io/math1710/'
---

# Schedule {.unnumbered}

```{r include=FALSE}
knitr::opts_chunk$set(comment = NA)
```

\newcommand{\Var}{\operatorname{Var}}

::: {.oldsched}
**Week 4** (23--27 October):

* [**Lecture 7:** Independence and conditional probabilty](#L07-conditional) (Monday 23 October)
* [**Lecture 8:** Two theorems on conditional probability](#L08-two-theorems) (Wednesday 25 October)
* **Tutorial** on [Problem Sheet 2](#P2)
* [**Problem Sheet 2:**](#P2) Work through in preparation for your tutorial. Deadline for assessed questions: Monday 30 October.
* [**R Worksheet 3**](#R)
* **Office hours:** Friday 27 October, 11--12 and 1--2, [Physics Research Deck 9.320](https://mpaldridge.github.io/office.html) (*note change of venue*)
:::

::: {.mysched}
**Week 3** (16--20 October):

* [**Lecture 5:** Classical probability I](#L05-classical-i) (Monday 16 October)
* [**Lecture 6:** Classical probability II](#L06-classical-ii) (Wednesday 18 October)
* **R Practical**
* [**Problem Sheet 2:**](#P2) Work through in preparation for your tutorial in Week 4. Deadline for assessed questions: Monday 30 October.
* [**R Worksheet 2:**](#R) Deadline for assessed exercises: Monday 23 October
* **Office hours:** Friday 20 October, 11--12 and 1--2, [Maths Boardroom](boardroom.png)
:::

::: {.mysched}
**Week 2** (9--13 October):

* [**Lecture 3:** Sample spaces and events](#L03-events) (Monday 9 October)
* [**Lecture 4:** Probability](#L04-probability) (Wednesday 11 October)
* **Tutorial** on [Problem Sheet 1](#P1)
* [**R Practical**](#practical)
* [**Problem Sheet 1:**](#P1) Work through in preparation for your tutorial. Deadline for assessed questions: Monday 16 October.
* [**R Worksheet 1**](#R)
* **Office hours:** Friday 13 October, 11--12 and 1--2, [Maths Boardroom](boardroom.png)
:::

::: {.mysched}
**Week 1** (2--6 October):

* [**Lecture 1:** Summary statistics](#L01-stats) (Monday 2 October)
* [**Lecture 2:** Data visualisation](#L02-dataviz) (Wednesday 4 October)
* [**Problem Sheet 1:**](#P1) Work through in preparation for your tutorial in Week 2. Deadline for assessed questions: Monday 16 October.
* **Office hours:** Friday 6 October, 11--12 and 1--2, [Maths Boardroom](boardroom.png)
:::

<!--
::: {.oldsched}
**Week 10** (5-9 December):

* [**Lecture 19:** The Bayesian idea](#L19-bayes-idea) (Monday 5 December)
* [**Lecture 20:** More Bayesian models](#L20-bayes-models): (Wednesday 7 December)
* [**Problem Sheet 5:**](#P5) Work through the short and long questions in preparation your tutorial. Deadline for assessed questions: *Monday 12 December*
* [**R Worksheet 10:** Law of large numbers](#r-work) to be completed this week
* [**R Worksheet 11:** Recap](#r-work) next week's sheet, available now due to the unusually early deadline: Thursday 15 December
:::

::: {.mysched}
**Week 9** (28 November -- 2 December):

* [**Lecture 17:** Exponential distribution and multiple continuous random variables](#L17-exponential-multi) (Monday 28 November)
* [**Lecture 18:** Limit theorems](#L18-limit): *The lecture on Wednesday 30 November will be cancelled; instead you should learn this material from the online notes and embedded videos*
* [**Problem Sheet 5:**](#P5) Work through the short and long questions in preparation your tutorial next week. Deadline for assessed questions: *Monday 12 December*
* [**R Worksheet 9:** Normal distribution](#r-work) to be completed this week; assessed work due Monday 5 December
:::

::: {.mysched}
**Week 8** (21--25 November):

* **Tutorials:** *All in-person tutorials cancelled. Online tutorial: Wednesday 23 November at 1000; recording available on Minerva.*
* [**Lecture 15:** Continuous random variables](#L15-continuous) (Monday 21 November)
* [**Lecture 16:** Normal distribution](#L16-normal) (Wednesday 23 November)
* [**Problem Sheet 4:**](#P4) Work through the short and long questions in preparation for *the online tutorial*. Deadline for assessed questions: *Tuesday 29 November*
* [**R Worksheet 8:** Discrete random variables](#r-work) to be completed this week
:::

::: {.mysched}
**Week 7** (14--18 November):

* [**Lecture 13:** Multiple random variables](#L13-multi-rv) (Monday 14 November)
* [**Lecture 14:** Expectation and covariance](#L14-covariance) (Wednesday 16 November)
* [**Problem Sheet 4:**](#P4) Work through the short and long questions in preparation for your tutorial next week. Deadline for assessed questions: Monday 28 November.
* [**R Worksheet 7:** Discrete distributions](#r-work) to be completed this week; assessed work due Monday 21 November.
:::

::: {.mysched}
**Week 6** (7--11 November):

* [**Lecture 11:** Binomial and geometric distributions](#L11-binomial-geometric) (Monday 7 November)
* [**Lecture 12:** Poisson distribution](#L12-poisson) (Wednesday 9 November)
* **Tutorial:** to discuss Problem Sheet 3; check your timetable for details.
* [**Problem Sheet 3:**](#P3) Work through the short and long questions in preparation for your tutorial. Deadline for assessed questions: Monday 14 November.
* [**R Worksheet 6:** R Markdown](#r-work) *optional* worksheet for this week.
:::

::: {.mysched}
**Week 5** (31 October -- 4 November):

* [**Lecture 9:** Discrete random variables](#L09-discrete-rv) (Monday 31 October)
* [**Lecture 10:** Expectation and variance](#L10-expectation) (Wednesday 2 November)
* [**Problem Sheet 3:**](#P3) Work through the short and long questions in preparation for your tutorial in Week 6. Deadline for assessed questions: Monday 14 November.
* [**R Worksheet 5:** Plots II](#r-work) to be completed this week. Deadline for assessed questions: Monday 7 November.
:::

::: {.mysched}
**Week 4** (24--28 October):

* [**Lecture 7:** Independence and conditional probability](#L07-conditional) (Monday 24 October)
* [**Lecture 8:** Two theorems on conditional probability](#L08-two-theorems) (Wednesday 26 October)
* **Tutorial:** to discuss Problem Sheet 2; check your timetable for details.
* [**Problem Sheet 2:**](#P2) Work through the short and long questions in preparation for your tutorial. Deadline for assessed questions: Monday 31 October.
* [**R Worksheet 4:** Plots I](#r-work) to be completed this week.
:::

::: {.mysched}
**Week 3** (17--21 October):

* [**Lecture 5:** Classical probability I](#L05-classical-i) (Monday 17 October)
* [**Lecture 6:** Classical probability II](#L05-classical-ii) (Wednesday 19 October)
* [**Problem Sheet 2:**](#P2) Work through the short and long questions in preparation for your tutorial in Week 4. Deadline for assessed questions: Monday 31 October.
* [**R Worksheet 3:** Data in R](#r-work) to be completed this week. Deadline for assessed questions: Monday 24 October.
:::

::: {.mysched}
**Week 2** (10--14 October):

* [**Lecture 3:** Sample spaces and events](#L03-events) (Monday 10 October)
* [**Lecture 4:** Probability](#L04-probability) (Wednesday 12 October)
* **Tutorial:** to discuss Problem Sheet 1; check your timetable for details.
* [**Problem Sheet 1:**](#P1) Work through the short and long questions in preparation for your tutorial. Deadline for assessed questions: Monday 17 October.
* [**R Worksheet 2:** Vectors](#r-work) to be completed this week.
:::


::: {.mysched}
**Week 1** (3--7 October):

* [**Lecture 1:** Summary statistics](#L01-stats) (Monday 3 October)
* [**Lecture 2:** Data visualisation](#L02-dataviz) (Wednesday 5 October)
* [**Problem Sheet 1:**](#P1) Work through the short and long questions in preparation for your tutorial in Week 2. Deadline for assessed questions: Monday 17 October.
* [**R Worksheet 1:** R basics](#r-work) to be completed this week.
:::
-->

<!--chapter:end:index.Rmd-->

# About MATH1710 {#about .unnumbered}

## Organisation of MATH1710  {#organisation .unnumbered}

This module is **MATH1710 Probability and Statistics I**. (A small number of second-year scientists are taking this module as the first half of **MATH2700 Probability and Statistics for Scientists**.)

This module lasts for 11 weeks from 2 October to 15 December 2023. The exam will take place between 15 and 26 January 2024.

The module leader, the lecturer, and the main author of these notes is Dr Matthew Aldridge (you can call me "Matt", "Matthew", or "Dr Aldridge", pronounced "*old*-ridge").



### Lectures {#lectures .unnumbered}

The main way you will learn new material for this module is by attending lectures. There are two lectures per week. Because this is a very large class each lecture will be delivered twice:

* **Mondays** at 1200 or at 1400, in [Chemistry West LT F](chem-west-map.png)
* **Wednesdays** at 1500 in [Chemistry West LT F](chem-west-map.png) or at 1600 in [Roger Stevens LT 20](https://students.leeds.ac.uk/rooms?type=room&id=100044)

Check your timetable to see which lecture you are assigned to each day (or [click this link for a map of how to get to Chemistry West LT F]((chem-west-map.png)).

I recommend taking your own notes during the lecture. I will put brief summary notes from the lectures on this website, but will not reflect all the details I say and write during the lectures. Lectures will go through material quite quickly and the material may be quite difficult, so it's likely you'll want to spend time reading through your notes after the lecture.

You are probably reading the web version of the notes. If you want a PDF copy (to read offline or to print out), it can be downloaded via the top ribbon of the page. (Warning: I have not made as much effort to make the PDF as neat and tidy as I have the web version, and there may be formatting errors.) I am very keen to hear about errors in the notes, mathematical, typographical or otherwise. Please [email me](mailto:m.aldridge@leeds.ac.uk) if think you may have found any.

*Attendance at lectures is compulsory.*


### Problem Sheets {.unnumbered #problem-sheets}

There will be 5 problem sheets. Each problem sheet has a number of short and long questions, for you to work on in your own time to help you learn the material, and two assessed questions, which you should submit for marking.  The assessed questions on each problem sheet make up 3% of your mark on this module, for a total of 15%. Deadlines are 2pm on Mondays, although I'd recommend completing and submitting the work in the previous week.

| Problem Sheet | Lectures covered | Deadline for assessed work      |
|:-------------:|:----------------:|:-------------------------------:|
|       1       |  1 and 2         |   Monday 16 October  (Week 3)   |
|       2       |  3--6            |   Monday 30 October  (Week 5)   |
|       3       |  7--10           |   Monday 13 November (Week 7)   |
|       4       |  11--14          |   Monday 27 November (Week 9)   |
|       5       |  15--18          |   Monday 11 December (Week 11)   |

An informal Problem Sheet 6 covering material from Lectures 19 and 20 will be available. Lectures 21 and 22 are revision lectures with no new material.

Assessed questions should be submitted in online through the Gradescope platform.  Most students choose to hand-write their solutions on paper and then scan and submit on their phone using the Gradescope app. Further Gradescope details to follow nearer the first deadline.


### Tutorials {.unnumbered #tutorials}

Tutorials are small groups of about a dozen students. You have been assigned to one of 34 tutorial groups, each with a member of staff as the tutor. Your tutorial group will meet five times, in Weeks 2, 4, 6, 8, and 10; you should check your timetable to see when and where your tutorial group meets.

The tutorials are an interactive session, where the main goal will be to go over your answers to the non-assessed questions on the problems sheets, which you will have worked on in advance of the tutorial. In this smaller group, you will be able to ask detailed questions of your tutor, and have the chance to discuss your answers to the problem sheet. Your tutor may ask you to present some of your work to your fellow students, or may give you the opportunity to work together with others during the tutorial. Your tutor may be willing to give you a hint on the assessed questions if you've made a first attempt but have got stuck. Because of the much smaller groups, the tutorials are the most valuable type of teaching on the module; you should make sure you attend, and you should be well prepared to ensure you make the most of the opportunity.

My recommended approach to problem sheets and tutorials is the following:

* Work through the problem sheet before the tutorial, spending plenty of time on it, and making multiple efforts at questions you get stuck on. I recommend spending *at least 4 hours per problem sheet*. This is a long time, but you shouldn't expect to be able to answer the hardest questions on a problem sheet without making multiple attempts. You don't have to wait until all lectures in a section are complete until starting to work on some of the questions. Collaboration is encouraged when working through the non-assessed problems, but I recommend writing up your work on your own; answers to assessed questions must be solely your own work.
* Take advantage of the small group setting of the tutorial to ask for help or clarification on questions you weren't able to complete.
* After the tutorial, attempt again the questions you were previously stuck on.
* If you're still unable to complete a question after this second round of attempts, *then* consult the solutions.

Your tutor will also be the marker of your answers to the assessed questions on the problem sheets.

*Attendance at tutorials is compulsory.*


### R Worksheets and Practicals {.unnumbered #r-worksheets}

R is a programming language that is particularly good at working with probability and statistics. Learning to use R is an important part of this module, and is used in many other modules in the University, including MATH1712 Probability and Statistics II. R is used by statisticians throughout academia and increasingly in industry too. Learning to program is a valuable skill for all students, and learning to use R is particularly valuable for students interested in statistics and related topics like actuarial science.

You will learn R by working through one R worksheet each week in your own time, starting from Week 2. Even-numbered worksheets will also contain a few questions for assessment, which will be due by 2pm Monday the following week (except the last one). Each of these is worth 3% of your mark for a total of 15%. You will submit your answers through a Microsoft Form (details to follow later). I recommend spending one hour per week on the week's R worksheet, plus one extra hour if there are assessed questions that week.

| Week | Worksheet                     | Deadline for assessed work |
|:----:|-------------------------------|:--------------------------:|
|   2  |  1: R basics  | --- |
|   3  |  2: Vectors   | Monday 23 October (Week 4) |
|   4  |  3: Data in R  | --- |
|   5  |  4: Plots I -- Making plots  | Monday 6 November (Week 6) |
|   6  |  5: Plots II -- Making plots better  | --- |
|   7  |  6: Discrete distributions   |      Monday 20 November (Week 8)   |
|   8  |  7: Discrete random variables  | --- |
|   9  |  8: Normal distribution | Monday 4 December (Week 10) |
|  10  |  9: Law of large numbers     |             ---           |
|  11  |  10: Recap | Thursday 14 December (Week 11) | 

 

**R Practical sessions:** You will be introduced you to R in your first Practical session, in Week 2. You will first see how to use R on University computers (these sessions will take place in computer "clusters"). There will then be an opportunity to install R on your own device -- if you have a laptop on which you want to install R, bring it along to the practical session. A second practical, in Week 3, will allow you to get help on the R Worksheet 2, which is the first worksheet with assessed questions.

There are 11 R practical session groups -- check your timetable for Weeks 2 and 3 to see when and where your group meets.

*Attendance at the first R practical session (Week 2) is compulsory.*


### "Office hours" drop-in sessions {.unnumbered #dropin}

If you there is something in the module you wish to discuss one-on-one with the module leader, the place for the is the optional weekly "office hours", which will operate as drop-in sessions. These sessions are an optional opportunity for you to ask questions you have to me; these are particularly useful if there's something on the module that you are stuck on or confused about, but I'm happy to discuss any statistics-related issues or questions you have.

I currently plan two "office hours" drop-in sessions per week:

* Fridays 1100--1200 and 1300--1400 in the [Mathematics Boardroom (map)](boardroom.png).

I may change arrangements as term continues -- if attendance levels are low, I will move office hours to be actual office.

If neither time is possible, you may [email me](mailto:m.aldridge@leeds.ac.uk) to arrange an alternative time to talk to me.

*Attendance at "office hours" sessions is optional.*


### Time management {.unnumbered #time}

It is, of course, up to you how you choose to spend your time on this module. But my recommendations for your work would be something like this:

* **Lectures:** 2 hours per week, plus 1 hour per week reading through notes.
* **Problem sheets:** 4 hours per problem sheet, plus 1 extra hour for writing up and submitting answers to assessed questions.
* **R worksheets:** 1 hour per week, plus 1 extra hour if there are assessed questions.
* **Tutorials:** 1 hour every other week.
* **Revision:** 16 hours total at the end of the module.
* **Exam:** 2 hours.

That makes about 100 hours in total. (MATH1710 is a 10-credit module, so is supposed to represent 100 hours work. MATH2700 students are expected to be able to use their greater experience to get through the material in just 75 hours, so should scale these recommendations accordingly.)


### Exam {.unnumbered #exam}

There will be an exam in January, which makes up the remaining 70% of your mark. The exam will consist of 20 short and 2 long questions, and will be time-limited to 2 hours. We'll talk more about the exam format near the end of the module.


### Who should I ask about...?  {.unnumbered #ask}

There are over 440 students registered for this module. If each student emails me once a week, and if each email takes me 10 minutes to read and respond, that will take more than 15 hours of my time every day! Generally, it's much better to come to speak to me at the "office hours" drop-in session or, if it will be very quick, before or after a lecture.

* *I don't understand something in the notes or on a problem sheet*: Come to office hours, or ask your tutor in your next tutorial.
* *I'm having difficulties with R:* In Weeks 2 or 3, you should ask at your R practical session; at other times, come to office hours.
* *I have an admin question about arrangements for the module:* Come to office hours or talk to me before/after lectures.
* *I have an admin question about arrangements for my tutorial:* Contact your tutor.
* *I have an admin question about general arrangements for my programme as a whole:* [Contact the Student Information Service](https://students.leeds.ac.uk/askingforhelp) or speak to your personal tutor.
* *I have a question about the marking of my assessed work on the Problem Sheets:* First, check your feedback on Gradescope; if you still have questions, contact your tutor.
* *I have a question about the marking of my assessed work on the R Worksheets:* You can [email me](mailto:m.aldridge@leeds.ac.uk) about this.
* *Due to truly exceptional and unforeseeable personal circumstances I require an extension on or exemption from assessed work:* You can apply by [filling in the mitigating circumstances form at this link](https://students.leeds.ac.uk/info/10111/assessment/860/mitigating_circumstances). Neither I nor your tutor can unilaterally offer an extension or exemption, so please don't ask. (Extensions of up to 4 days are available for Problem Sheets. Only exemptions are available for R Worksheets.) 



## Content of MATH1710 {.unnumbered #about-content}


### Prerequisites {.unnumbered #prereqs}

The formal prerequisite for MATH1710 is "Grade B in A-level Mathematics or equivalent". I'll assume you have some basic school-level maths knowledge, but I won't assume you've studied probability or statistics in detail before (although I recognise that many of you will have). If you have studied probability and/or statistics at A-level (or post-16 equivalent) level, you'll recognise some of the material in this module; however you should find that we go deeper in many areas, and that we treat the material through with a greater deal of mathematical formality and rigour. "Rigour" here means precisely stating our assumptions, and carefully *proving* how other statements follow from those assumptions.


### Syllabus {.unnumbered #syllabus}

The module has three parts: a short first part on "exploratory data analysis", a long middle part on probability theory, and a short final part on a statistical framework called "Bayesian statistics". There's also the weekly R worksheets, which you could count as a fourth part running in parallel, but which will connect with the other parts too.

An outline plan of the topics covered is the following.

* **Exploratory data analysis** [2 lectures]: Summary statistics, data visualisation
* **Probability** [16 lectures]:
   * Probability with events: Probability spaces, probability axioms, examples and properties of probability, "classical probability" of equally likely events, independence, conditional probability, Bayes' theorem [6 lectures]
   * Probability with random variables: Discrete random variables, expectation and variance, binomial distribution, geometric distribution, Poisson distribution, multiple random variables, law of large numbers, continuous random variables, exponential distribution, normal distribution, central limit theorem [10 lectures]
* **Bayesian statistics** [2 lectures]: Bayesian framework, Beta prior, normal--normal model
* Summary and revision [2 lectures]

You'll notice that this module is heavier on the "Probability" than the "Statistics" of its title. MATH1712 Probability and Statistics II, on the other hand, which many students on this module will take next semester, is almost entirely "Statistics", but uses probabilistic techniques developed here.


### Books {.unnumbered #books}

You can do well on this module by attending the lectures and tutorials, and working on the problem sheets and R worksheets, without needing to do any further reading beyond this. However, students can benefit from optional pre-reading in advance, extra background reading, or an alternative view on the material, especially in the parts of the module on probability. These books are also a good place to look if you want extra exercises and problems for revision.

For exploratory data analysis, you can stick to Wikipedia, but if you really want a book, I'd recommend:

* GM Clarke and D Cooke, *A Basic Course in Statistics*, 5th edition, Edward Arnold, 2004.

For the probability section, any book with a title like "Introduction to Probability" would do. Some of my favourites are:

* JK Blitzstein and J Hwang, *Introduction to Probability*, 2nd edition, CRC Press, 2019.
* G Grimmett and D Welsh, *Probability: An Introduction*, 2nd edition, Oxford University Press, 2014. (The library has [online access](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991002938669705181).)
* SM Ross, *A First Course in Probability*, 10th edition, Pearson, 2020.
* RL Scheaffer and LJ Young, *Introduction to Probability and Its Applications*, 3rd edition, Cengage, 2010.
* D Stirzaker, *Elementary Probability*, 2nd edition, Cambridge University Press, 2003. (The library has [online access](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181).)

I also found lecture notes by [Prof Oliver Johnson](https://people.maths.bris.ac.uk/~maotj/teaching.html) (University of Bristol) and [Prof Richard Weber](http://www.statslab.cam.ac.uk/~rrw1/prob/index.html) (University of Cambridge) to be useful.

On Bayesian statistics, we will only taste a brief introduction, but if you want a book, I recommend:

* JV Stone, *Bayes' Rule: A Tutorial Introduction to Bayesian Analysis*, Sebtel Press, 2013.

For R, there are many excellent resources online.

(For all these books I've listed the newest editions, but older editions are usually fine too.)


## About these notes  {#about-notes .unnumbered}

These notes were written by Matthew Aldridge in 2021, and were edited and updated a lot in 2022 and a little bit in 2023. They are based in part on previous notes by Dr Robert G Aykroyd and Prof Wally Gilks. Dr Jason Susanna Anquandah and Dr Aykroyd advised on the R worksheets. Dr Aykroyd's help and advice on many aspects of the module was particularly valuable.

These notes (in the web format) should be accessible by screenreaders. If you have accessibility difficulties with these notes, [contact me](mailto:m.aldridge@leeds.ac.uk).

<!--chapter:end:about.Rmd-->

# (PART\*) Part I: Exploratory data analysis  {-}

# Summary statistics {#L01-stats}

## What is EDA? {#what-is-eda}

**Statistics** is the study of data. **Exploratory data analysis** (or **EDA**, for short) is the part of statistics concerned with taking a "first look" at some data. Later, toward the end of this module, we will see more detailed and complex ways of building models for data, and in MATH1712 Probability and Statistics II (for those who take it) you will see many other statistical techniques -- in particular, ways of testing formal hypotheses for data. But here we're just interested in first impressions and brief summaries.

In this section, we will concentrate on two aspects of EDA:

* **Summary statistics:** That is, calculating numbers that briefly summarise the data. A summary statistic might tell us what "central" or "typical" values of the data are, how spread out the data is, or about the relationship between two different variables.
* **Data visualisation:** Drawing a picture based on the data is an another way to show the shape (centrality and spread) of data, or the relationship between different variables.

Even before calculating summary statistics or drawing a plot, however, there are other questions it is important to ask about the data:

* *What is the data?* What variables have been measured? How were they measured? How many datapoints are there? What is the possible range of responses?
* *How was the data collected?* Was data collected on the whole population or just a smaller sample? If a sample: How was that sample chosen? Is that sample representative of the population?
* *Are there any outliers?* "Outliers" are datapoints that seem to be very different from the other datapoints -- for example, are much larger or much smaller than the others. Each outlier should be investigated to seek the reason for it. Perhaps it is a genuine-but-unusual datapoint (which is useful for understanding the extremes of the data), or perhaps there is an extraordinary explanation (a measurement or recording error, for example) meaning the data is not relevant. Once the reason for an outlier is understood, it then *might* be appropriate to exclude it from analysis (for example, the incorrectly recorded measurement). It's usually bad practice to exclude an outlier merely for being an outlier before understanding what caused it.
* *Ethical questions:* Was the data collected ethically and, where necessary, with the informed consent of the subjects? Has it been stored properly? Are their privacy issues with the collection and storage of the data? What ethical issues should be considered before publishing (or not publishing) results of the analysis? Should the data be kept confidential, or should it be openly shared with other researchers for the betterment of science?


## What is R?  {#what-is-R}

**R** is a programming language that is particularly good at working with probability and statistics. A convenient way to use the language R is through the program **RStudio**. An important part of this module is learning to use R, by completing weekly worksheets -- you can read more in [the R section of these notes](#R).

R can easily and quickly perform all the calculations and draw all the plots in this section of notes on exploratory data analysis. In this text, we'll show the relevant R code. Code will appear like this:

```{r}
data <- c(4, 7, 6, 7, 4, 5, 5)
mean(data)
```

Here, the code in the first shaded box is the R commands that are typed into 
RStudio, which you can type in next to the `>` arrow in the RStudio "console". The numerical answers that R returns are shown here in the second unshaded box. The `[1]` can be ignored (this is just R's way of saying that this is the first part of the answer -- but the answer here only has one part anyway). Plots produced by R are displayed in these notes as pictures.

Most importantly for now, *you are not expected to understand the R code in this section yet*. The code is included so that, in the future, as you work through the R worksheets week by week, you can look back at the code in the section, and it will start to make sense. By the time you have finished R Worksheet 5 in Week 6, you should be able understand most of the R code in this section.


## Statistics of centrality  {#stat-central}

<!--
:::: {.videowrap}
::: {.videowrapper}
<iframe src="https://www.youtube.com/embed/_OaCRCFZXoY"></iframe>
:::
::::
-->

Suppose we have collected some data on a certain variable. We will assume here that we have $n$ datapoints, each of which is a single real number. We can write this data as a vector
\[ \mathbf x = (x_1, x_2, \dots, x_n) . \]

A **statistic** is a calculation from the data $\mathbf x$, which is (usually) also a real number. In this section we will look at two types of "summary statistics", which are statistics that we feel will give us useful information about the data.

We'll look here at two types of summary statistic:

* **Statistics of centrality**, which tell us where the "middle" of the data is.
* **Statistics of spread**, which tell us how far the data typically spreads out from that middle.

Some measures of centrality are the following.

::: {.definition}
Consider some real-valued data $\mathbf x = (x_1, x_2, \dots, x_n)$.

* The **mode** is the most common value of $x_i$. (If there are multiple joint-most common values, they are all modes.)
* Suppose the data is ordered as $x_1 \leq x_2 \leq \cdots \leq x_n$. Then the **median** is the central value in the ordered list. If $n$ is odd, this is $x_{(n+1)/2}$; if $n$ is even, we normally take halfway between the two central points, $\frac12(x_{n/2}+x_{n/2 + 1})$.
* The **mean** $\bar x$ is
\[ \bar x = \frac{1}{n}(x_1 + x_2 + \cdots + x_n) = \frac1n \sum_{i=1}^n x_i . \]
:::

In that last expression, we've made use of Sigma notation to write down the sum. (If Sigma notation is new to you, I recommend [this PDF from MathCentre](https://www.mathcentre.ac.uk/resources/workbooks/mathcentre/sigma.pdf), or Section 2.4 of Clarke and Cooke, *A Basic Course in Statistics*.)

::: {.example}
Some packets of Skittles (a small fruit-flavoured sweet) were opened, and the number of Skittles in each packet counted. There were 13 packets, and the number of sweets (sorted from smallest to largest) were:
\[ 59, \ 59, \ 59, \ 59, \ 60, \ 60, \ 60, \ 61, \ 62, \ 62, \ 62, \ 63, \ 63 .\]

The mode is 59, because there were 4 packets containing 59 sweets; more than any other number.

Since there are $n = 13$ packets, the middle packet is number $i = 7$, so the median is $x_7 = 60$.

The mean is
\[ \bar x = \frac{1}{13} (59 + 59 + \cdots + 63) = \frac{789}{13} = 60.7 .\]
:::

The median is one example of a "quantile" of the data. Suppose our data is increasing order again. For $0 \leq \alpha \leq 1$, the **$\alpha$-quantile** $q(\alpha)$ of the data is the datapoint $\alpha$ of the way along the list. Generally, $q(\alpha)$ is equal to $x_{1+\alpha(n-1)}$ when $1+\alpha(n-1)$ is an integer. (If $1+\alpha(n-1)$ isn't an integer, there are various conventions of how to choose that we won't go into here. R has *nine* different settings for choosing quantiles! -- we will always just use R's default choice.)

* The **median** is the $\frac12$-quantile $q(\frac12)$, which is $q(\frac12) = x_7 = 60$ for this data.
* The **minimum** is the 0-quantile $q(0)$, which is $q(0) = x_1 = 59$ for this data.
* The **maximum** is the 1-quantile $q(1)$, which is $q(1) = x_{13} = 63$ for this data
* The **lower quartile** (that's "quartile", as in "quarter" -- not "quantile") is the $\frac14$-quantile $q(\frac14)$, which is $q(\frac14) = x_4 = 59$ for this data.
* The **upper quartile** is the $\frac34$-quantile $q(\frac34)$, which is $q(\frac34) = x_{10} = 62$ for this data.

The following R code reads in some data which has the daily average temperature in Leeds in 2020, divided into months. We can find, for example, the mean October temperature or the lower quartile of the July temperature.

```{r}
temperature <- read.csv("https://mpaldridge.github.io/math1710/data/temperature.csv")
jul <- temperature[temperature$month == "jul", ]
oct <- temperature[temperature$month == "oct", ]

mean(oct$temp)
quantile(jul$temp, probs = 1 / 4)
```



## Statistics of spread {#stat-spread}

Some measures of spread are:

::: {.definition}
The **number of distinct observations** is precisely that: the number of different datapoints we have after removing any repeats.

The **interquartile range** is the difference between the upper and lower quartiles $\text{IQR} = q(\frac34) - q(\frac14)$.

The **sample variance** is
\[  s^2_x = \frac{1}{n-1} \left((x_1 - \bar x)^2 + \cdots + (x_n - \bar x)^2 \right) = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar x)^2 , \]
where $\bar x$ is the sample mean from before. The **standard deviation** $s_x = \sqrt{s^2_x}$ is the square-root of the sample variance.
:::

::: {.example}
We continue with the Skittles data.

The number of distinct observation is 5. (These are 59, 60, 61, 62, and 63.)

The interquartile range is $x_{10} - x_4 = 62 - 59 = 3$.

You will calculate the sample variance on [Problem Sheet 1](#P1).
:::

The formula we've given for sample variance is sometimes called the "definitional formula", as it's the formula used to *define* the sample variance. We can rearrange that formula as follows:
\begin{align*}
  s^2_x &= \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar x)^2 \\
      &= \frac{1}{n-1} \sum_{i=1}^n (x_i^2 - 2x_i\bar x + \bar x^2) \\
      &= \frac{1}{n-1}\left(\sum_{i=1}^nx_i^2 - \sum_{i=1}^n 2x_i\bar x + \sum_{i=1}^n\bar x^2 \right) \\
      &= \frac{1}{n-1} \left(\sum_{i=1}^n x_i^2 - 2\bar x \sum_{i=1}^n x_i + \bar x^2 \sum_{i=1}^n 1 \right) \\
      &= \frac{1}{n-1} \left(\sum_{i=1}^n x_i^2 - 2n\bar x^2 + n\bar x^2 \right) \\
      &= \frac{1}{n-1} \left(\sum_{i=1}^n x_i^2 -  n\bar x^2 \right) .
\end{align*}
Here, the first line is the definitional formula; the second line is from expanding out the bracket; the third line is taking the sum term-by-term; the fourth line takes any constants (things not involving $i$) outside the sums; the fifth line uses $\sum_{i=1}^n x_i = n\bar x$, from the definition of the mean, and $\sum_{i=1}^n 1 = 1 + 1 + \cdots 1 = n$; and the sixth line simplifies the final two terms.

This has left us with
\[ s^2_x = \frac{1}{n-1} \left(\sum_{i=1}^n x_i^2 -  n\bar x^2 \right) . \]
This is sometimes called the "computational formula"; this is because it usually takes fewer presses of calculator buttons to compute the sample variance with this formula rather than the definitional formula. (But make sure you keep enough decimal points in $\bar x^2$.)

Going back to our weather data in R, we can find the sample variance of the October weather or the interquartile range of the July weather.

```{r}
var(oct$temp)
IQR(jul$temp)
```

## Summary  {#summary-01 .unnumbered}

::: {.mysummary}
* Exploratory data analysis is about taking a first look at data.
* Summary statistics are numbers calculated from data that give us useful information about the data.
* Summary statistics that measure the centre of the data include the mode, median, and mean.
* Summary statistics that measure the spread of the data include the number of distinct outcomes, the interquartile range, and the sample variance.
:::

**Recommended reading:**

* Wikipedia: [Exploratory data analysis](https://en.wikipedia.org/wiki/Exploratory_data_analysis), [Mode (statistics)](https://en.wikipedia.org/wiki/Mode_(statistics)), [Median](https://en.wikipedia.org/wiki/Median), [Arithmetic mean](https://en.wikipedia.org/wiki/Arithmetic_mean), [Quantile](https://en.wikipedia.org/wiki/Quantile), [Interquartile range](https://en.wikipedia.org/wiki/Interquartile_range).
* Clarke and Cooke, *A Basic Course in Statistics*, Sections 2.1--2.4, 2.7, 4.1--4.4, 4.6, 4.7.

On [Problem Sheet 1](#P1), you should now be able to complete Questions A1, B1, B2, B4, C1.

<!--chapter:end:sections/L01-stats.Rmd-->

# Data visualisations  {#L02-dataviz}

Data visualisations -- drawings or graphs based on data -- can help us to understand the "shape" of a dataset as part of exploratory data anlaysis. In this lecture, we'll look at three types of data visualisation.

## Boxplots  {#boxplots}

A **boxplot** is a useful way to illustrate numerical data. It can be easier to tell the difference between different data sets "by eye" when looking at a boxplot, rather than examining raw summary statistics.

A boxplot is drawn as follows:

* The vertical axis represents the data values.
* Draw a box from the lower quartile $q(\frac14)$ to the median $q(\frac12)$.
* Draw another box on top of this from the median $q(\frac12)$ to the upper quartile $q(\frac34)$. Note that size of these two boxes put together is the interquartile range.
* Decide which datapoints are outliers, and plot these with circles. (The R default is that any data point less than $q(\frac14) - 1.5 \times \text{IQR}$ or greater than $q(\frac34) + 1.5 \times \text{IQR}$ is an outlier.)
* Out from the two previous boxes, draw "whiskers" to the minimum and maximum non-outlier datapoints.

```{r boxplot1, cache = TRUE, echo = FALSE, fig.width = 6, fig.height = 7, fig.align = "center"}
set.seed(3)
x <- c(rnorm(200), rnorm(40, 0.2, 2.2), -4.5) + 5
boxplot(x, ylim = c(0,12))
text(1.2, quantile(x, 0.25), "lower quartile", pos = 4)
text(1.2, quantile(x, 0.5),  "median", pos = 4)
text(1.2, quantile(x, 0.75), "upper quartile", pos = 4)
text(1.12, 1.9, "min. non-outlier", pos = 4)
text(1.12, 7.7, "max. non-outlier", pos = 4)
text(1.05, 1, "outliers", pos = 4)
text(1.05, 9, "outliers", pos = 4)
```

When we have multiple datasets, drawing boxplots next to each other can help us to compare the datasets. Here are two boxplots from the July and October temperature data we used in the last lecture. What do you conclude about the data from these boxplots?

```{r boxplot-temp, cache = TRUE, fig.width = 5, fig.align = "center"}
boxplot(jul$temp, oct$temp,
        names = c("July", "October"),
        ylab = "Daily maximum temperature (degrees C) in Leeds"
)
```

(And yes, I [did check the outlier](https://www.metoffice.gov.uk/binaries/content/assets/metofficegovuk/pdf/weather/learn-about/uk-past-events/interesting/2020/2020_05_july_temperature.pdf) to make sure it was a genuine datapoint.)


## Histograms  {#histograms}

<!--
:::: {.videowrap}
::: {.videowrapper}
<iframe src="https://www.youtube.com/embed/QAsyIh-Gfts"></iframe>
:::
::::
-->

Often when collecting data, we don't collect exact data, but rather collect data clumped into "bins". For example, suppose a student wished to use a questionnaire to collect data on how long it takes people to reach campus from home; they might not ask "Exactly how long does it take?", but rather give a choice of tick boxes: "0--5 minutes", "5--10 minutes", and so on.

Consider the following binned data, from $n = 100$ students:

|       Time      | Frequency | Relative frequency |
|:---------------:|:---------:|:------------------:|
|   0--5 minutes  |     4     |        0.04        |
|  5--10 minutes  |     8     |        0.08        |
|  10--15 minutes |     21    |        0.21        |
|  15--30 minutes |     42    |        0.42        |
|  30--45 minutes |     15    |        0.15        |
|  45--60 minutes |     8     |        0.08        |
| 60--120 minutes |     2     |        0.02        |
|    **Total**    |    100    |          1         |

Here the **frequency** $f_j$ of bin $j$ is simply the number of observations in that bin; so, for example, 42 students had journey lengths of between 15 and 30 minutes. The **relative frequency** of bin $j$ is $f_j/n$; that is, the proportion of the observations in that bin.

Which bin would you say is the most popular -- that is, the "modal" bin? The bin with the most observations in it is the "15--30 minute" bin. But this bin covers 15 minutes, while some of the other bins only cover 5 minutes. It would be a fairer comparison to look at the **frequency density**: the relative frequency divided by the size of the bin.

|       Time      | Frequency | Relative frequency | Frequency density |
|:---------------:|:---------:|:------------------:|:-----------------:|
|   0--5 minutes  |     4     |        0.04        |       0.008       |
|  5--10 minutes  |     8     |        0.08        |       0.016       |
|  10--15 minutes |     21    |        0.21        |       0.042       |
|  15--30 minutes |     42    |        0.42        |       0.028       |
|  30--45 minutes |     15    |        0.15        |       0.010       |
|  45--60 minutes |     8     |        0.08        |       0.005       |
| 60--120 minutes |     2     |        0.02        |       0.0003      |
|    **Total**    |    100    |          1         |                   |

In the first row, for example, the relative frequency is 0.04 and the size of the bin is 5 minutes, so the frequency density is $0.04/5 = 0.008$. We now see that the modal bin -- the bin with the highest frequency *density* -- is in fact the "10--15 minutes" bin. This bin has somewhat fewer datapoints that the "15--30 minutes" bin, but they're squashed into a much smaller bin.

Data in bins can be illustrated with a **histogram**. A histogram has the measurement on the x-axis, with one bar across the width of each bin, where bars are drawn up to the height of the corresponding frequency density. Note that this means that the area of the bar is exactly the relative frequency of the corresponding bin.

If all the bins are the same width, frequency density is directly proportional to frequency and to relative frequency, so it can be clearer use one of those as the y-axis instead in the equal-width-bins case.

Here is a histogram for our journey-time data:

```{r journeys, cache = TRUE}
journeys <- read.csv("https://mpaldridge.github.io/math1710/data/journeys.csv")
bins <- c(0, 5, 10, 15, 30, 45, 60, 120)

hist(journeys$midpoint, breaks = bins,
     xlab = "Journey length (min)", ylab = "frequency density", main = ""
)
```

Often we draw histograms because the data was collected in bins in the first place. But even when we have exact data, we might *choose* to divide it into bins for the purposes of drawing a histogram. In this case we have to decide where to put the "breaks" between the bins. Too many breaks too close together, and the small number of observations in each bin will give "noisy" results (see left); too few breaks too far apart, and the wide bins will mean we lose detail (see right).
```{r, echo = FALSE}
set.seed(4)
```

```{r hist-bins, cache = TRUE, fig.show="hold", out.width="48%", fig.width = 4}
set.seed(2172)
hist_data <- c(rnorm(30, 8, 2), rnorm(40, 12, 3))  # Some fake data

hist(hist_data, breaks = 40, main = "Too many bins")
hist(hist_data, breaks = 2,  main = "Too few bins")
```

We can also calculate some summary statistics even when we have binned data. We mentioned the mode earlier, where the modal bin is the bin of highest frequency density.

What is the median journey length? Well, we don't know exactly, but $0.04 + 0.08 + 0.21$ (the first three bins) is less than 0.5, while $0.04 + 0.08 + 0.21 + 0.42$ (including the fourth bin) is greater than 0.5. So we know that the median student is in the fourth bin, the "15--30 minute" bin, and we can say that the median journey length is between 15 and 30 minutes.

Since we don't have the exact data, it's not possible to exactly calculate the mean and variance. However, we can often get a good estimate by assuming that each observation was in fact right in the centre of its bin. So, for example, we could assume that all 4 observations in the "0--5 minutes" bin were journeys of exactly 2.5 minutes. Of course, this isn't true (or is highly unlikely to be true), but we can often get a good approximation this way.

For our journey-time data, our approximation of the mean would be
\[ \bar x = \frac{1}{100} \big(4\times 2.5 + 8 \times 7.5 + \cdots + 2\times90) = 24.4 . \]
More generally, if $m_j$ is the midpoint of bin $j$ and $f_j$ its frequency, then we can calculate the binned mean and binned variance by
\begin{align*}
  \bar x &= \frac{1}{n} \sum_j f_j m_j \\
  s^2_x  &= \frac{1}{n-1} \sum_j f_j (m_j - \bar x)^2
\end{align*}

## Scatterplots  {#scatterplots}

<!--
:::: {.videowrap}
::: {.videowrapper}
<iframe src="https://www.youtube.com/embed/5iT_fPjqXFs"></iframe>
:::
::::
-->

Often, more than one piece of data is collected from each subject, and we wish to compare that data, to see if there is a relationship between the variables.

For example, we could take $n$ second-year maths students, and for each student $i$, collect their mark $x_i$ in MATH1710 and their mark $y_i$ in MATH1712. This gives is two "paired" datasets, $\mathbf x = (x_1, x_2, \dots, x_n)$ and $\mathbf y = (y_1, y_2, \dots, y_n)$. We can calculate sample statistics of draw plots for $\mathbf x$ and for $\mathbf y$ individually. But we might also want to see if there is a relationship *between* $\mathbf x$ and $\mathbf y$: Do students with high marks in MATH1710 also get high marks in MATH1712?

A good way to visualise the relationship between two variables is to use a **scatterplot**. In a scatterplot, the $i$th data pair $(x_i, y_i)$ is illustrated with a mark (such as a circle or cross) whose x-coordinate has the value $x_i$ and whose y-coordinate has the value $y_i$.

In the following scatterplot, we have $n = 50$ datapoints for the 50 US states; for each state $i$, $x_i$ is the Republican share of the vote in that state in the 2016 Trump--Clinton presidential election, and $y_i$ is the Republican share of the vote in that state in the 2020 Trump--Biden election.

```{r elections, cache = TRUE}
elections <- read.csv("https://mpaldridge.github.io/math1710/data/elections.csv")

plot(elections$X2016, elections$X2020,
     col = "blue",
     xlab = "Republican share of the two-party vote, 2016 (%)",
     ylab = "Republican share of the two-party vote, 2020 (%)")

abline(h = 50, col = "grey")
abline(v = 50, col = "grey")
abline(0.195, 0.963, col = "red")
```

We see that there is a strong relationship between $\mathbf x$ and $\mathbf y$, with high values of $x$ corresponding to high values of $y$ and vice versa. Further, the points on the scatterplot lie very close to a straight line.

A useful summary statistic here is the **correlation**
\[ r_{xy} = \frac{s_{xy}}{s_x s_y} , \]
where $s_{xy}$ is the **sample covariance**
\begin{align*}
s_{xy} &= \frac{1}{n-1} \big( (x_1 - \bar x)(y_1 - \bar y) + \cdots + (x_n - \bar x)(y_n - \bar y) \big) \\
  &= \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar x)(y_i - \bar y) ,
\end{align*}
and $s_x = \sqrt{s_x^2}$ and $s_y = \sqrt{s_y^2}$ are the standard deviations.

The correlation $r_{xy}$ is always between $-1$ and $+1$. Values of $r_{xy}$ near $+1$ indicate that the scatterpoints are close to a straight line with an upward slope (big $x$ = big $y$); values of $r_{xy}$ near $-1$ indicate that the scatterpoints are close to a straight line with a downward slope (big $x$ = small $y$); and values of $r_{xy}$ near 0 indicate that there is a weak linear relationship between $x$ and $y$.

For the elections data, the correlation is
```{r, cache = TRUE}
cor(elections$X2016, elections$X2020)
```
which, as we expected, is extremely high.

## Summary  {#summary-02 .unnumbered}

::: {.mysummary}
* Boxplots show the shape of numerical data, and can compare different datasets.
* Histograms show the shape of binned data.
* Scatterplots show the relationship between two datasets.
:::

**Recommended reading:**

* Wikipedia: [Box plot](https://en.wikipedia.org/wiki/Box_plot), [Histogram](https://en.wikipedia.org/wiki/Histogram), [Grouped data](https://en.wikipedia.org/wiki/Grouped_data), [Scatter plot](https://en.wikipedia.org/wiki/Scatter_plot), [Pearson correlation coefficient](https://en.wikipedia.org/wiki/Pearson_correlation_coefficient).
* Clarke and Cooke, *A Basic Course in Statistics*, Sections 1.2, 2.5, 4.5, 4.6, 21.2, 21.3.

On [Problem Sheet 1](#P1), you should now be able to complete all questions.



<!--chapter:end:sections/L02-dataviz.Rmd-->

# Problem Sheet 1  {#P1 .unnumbered}


<style>
.myanswers { 
display: none !important;
}
</style>



\commfalse

::: {.mysummary}
[**Solutions** are now available](#P1-solutions) to all non-assessed questions.
:::

::: {.mysummary}
You can [download this problem sheet as a PDF file](P1-sheet.pdf)
:::

::: {.mysummary}
This is Problem Sheet 1, which covers material from Lectures [1](#L01-stats) and [2](#L02-dataviz) of the notes. You should work through all the questions on this problem sheet in advance of your tutorial in Week 2. Questions C1 and C2 are assessed questions, and are due in by **2pm on Monday 16 October**. I recommend spending about 4 hours on this problem sheet, plus 1 extra hour to neatly write up and submit your answers to the assessed questions.
:::

## A: Short questions {#P1-short .unnumbered}

::: {.mysummary}
The first three questions are **short questions**, which are intended to be mostly not too difficult. Short questions usually follow directly from the material in the lectures. Here, you should clearly state your final answer, and give enough working-out (or a short written explanation) for it to be clear how you reached that answer. You can check your answers with the solutions-without-working at the bottom of this sheet; solutions-with-working will be available after Friday 13 October. If you get stuck on any of these questions, you might want to ask for guidance in your tutorial.
:::

```{r, child = "problems/questions/P1-short.Rmd"}
```

## B: Long questions {#P1-long .unnumbered}

::: {.mysummary}
The next four questions are **long questions**, which are intended to be harder. Long questions often require you to think originally for yourself, not just directly follow procedures from the notes. You may not be able to solve all of these questions, although you should make multiple attempts to do so. Here, your answers should be written in complete sentences, and you should carefully explain in words each step of your working. Your answers to these questions -- not only their mathematical content, but also how to write good, clear solutions -- are likely to be the main topic for discussion in your tutorial. Solutions will be available after Friday 13 October.
:::

```{r, child = "problems/questions/P1-long.Rmd"}
```

## C: Assessed questions {#P1-assessed .unnumbered}

::: {.mysummary}
The last two questions are **assessed questions**. This means you will submit your answers, and your answers will be marked by your tutor. These two questions count for 3% of your final mark for this module. If you get stuck, your tutor may be willing to give you a small hint in your tutorial.

The deadline for submitting your solutions is **2pm on Monday 16 October** at the beginning of Week 3. Submission will be via Gradescope, which you can access via Minerva or on the Gradescope mobile app.
You should submit your answers as a single PDF file. Most students choose to hand-write their work on paper, then scan-and-submit it to using the Gradescope mobile app. Your work will be marked by your tutor and returned on Monday 23 October, when solutions will also be made available.

Question C1 is a "short question", where brief explanations or working are sufficient; Question C2 is a "long question", where the marks are not only for mathematical accuracy but also for the clarity and completeness of your explanatory writing. 

You should not collaborate with others on the assessed questions: your answers must represent solely your own work. The University's rules on [academic integrity](https://library.leeds.ac.uk/info/1401/academic_skills/46/academic_integrity_and_plagiarism) -- and the related punishments for violating them -- apply to your work on the assessed questions.
:::

```{r, child = "problems/questions/P1-assessed.Rmd"}
```

## Solutions to short questions {#P1-short-sols .unnumbered}

**A1.** (a) 60.7, (b) 2.40, (c) 2.40, (d) ---.  
**A2.** (a) ---, (b) 45--50, (c) 45--50, (d) 48.6 *(corrected)*.  
**A3.** ---

<!--chapter:end:problems/P1.Rmd-->

# (PART\*) Part II: Probability  {-}

# Sample spaces and events  {#L03-events}

\renewcommand{\complement}{\mathsf{c}}
\newcommand{\comp}{\complement}
\newcommand{\ff}[2]{{#1}^{\underline{#2}}}


## What is probability?  {#what-is-prob}

We now begin the big central block of this module, on probability theory.

Probability theory is the study of randomness. Probability, as an area of mathematics, is a fascinating subject in its own right. However, probability is particularly important due to its usefulness in applications -- especially in statistics (the study of data), in finance, and in actuarial science (the study of insurance).

Probability is well suited to modelling situations that involve randomness, uncertainty, or unpredictability. If you want to predict the time of the next solar eclipse, a deterministic (that is, non-random) model based on physical laws will tell you when the sun, the moon, and the earth will be in the correct positions; but if you want to predict the weather tomorrow, or the price of a share of Apple stock next month, or the results of an election next year, you will need a probabilistic model that takes into account the uncertainty in the outcome. A probabilistic model could tell you the most likely outcome, or a range of the most probable outcomes.

So what do we mean when we talk about the "probability" of an event occurring? You might say that the probability of an event is a measure of "how likely" it is to occur, or what the "chance" of it occurring is.

More concretely, here are some interpretations of probability:

* **Subjective** (or **Bayesian**) **probability:** The probability of an event is the way someone expresses their degree of belief that the event will occur, based on their own judgement, and given the evidence they have seen. Their belief is measured on a scale from 0 to 1, from probabilities near 0 meaning they believe the event is very unlikely to occur to probabilities near 1 meaning they believe the event is very likely to occur.
   * This interpretation is philosophically sound, but a bit vague to be the basis for a mathematics module.
* **Classical** (or **enumerative**) **probability:** Suppose there are a finite number of equally likely outcomes. Then the probability of an event is the proportion of those outcomes that correspond to the event occurring. So when we say that a randomly dealt card has a probability $\frac{1}{13}$ of being an ace, this is because there are 52 cards of which 4 are aces, so the proportion of favourable outcomes is $\frac{4}{52} = \frac{1}{13}$.
   * This interpretation is good for simple procedures like flipping a fair coin, rolling a dice, or dealing cards, where the "finite number of equally likely outcomes" assumption holds. But we want to be able to study more complicated situations, where some outcomes are more likely than others, or where infinitely many different outcomes are possible.
* **Frequentist probability:** In a repeated experiment, the probability of an event is its long-run frequency. That is, if we repeat an experiment a very large number of times, the probability of the event is (approximately) the proportion of the experiments in which the event occurs. So when we say a biased coin has probability 0.9 of landing heads, we mean that were we toss it 1000 times, we would expect to see very close to $0.9 \times 1000 = 900$ heads.
   * There are two problems with this. First, this doesn't deal with events that can't be repeated over and over again (like "What's the probability that Labour win the 2024 general election?"). Second, to answer the question, "Yes, but *how* close to the probability should the proportion of occurrences be?", you end up having to answer, "Well, it depends on the probability," and you've got a circular definition.
* **Mathematical probability:** We have a function that assigns to each event a number between 0 and 1, called its probability, and that function has to obey certain mathematical rules, called "axioms".

It will not surprise you to learn that, in this mathematics course, we will take the "mathematical probability" approach. However, we will also learn useful things about the other approaches: we will see that classical probability is one special case of mathematical probability; we will see a result called the "law of large numbers" that says that the long-run frequency does indeed get closer and closer to the mathematical probability; and a result called "Bayes' theorem" will advise a subjectivist on how to update her subjective beliefs when she sees new evidence.


## Sample spaces and events  {#sample-events}

Taking the "mathematical probability" approach, we will want to give a formal mathematical definition of the *probability* of an event. But even before that, we need to give a formal mathematical definition of an *event* itself. Our setup will be this:

* There is a set called the **sample space**, normally given the letter $\Omega$ (upper-case Omega), which is the set of all possible outcomes.
* An element of the sample space $\Omega$ is a **sample outcome**, sometimes given the letter $\omega$ (lower-case omega), represents one of the possible outcomes.
* An **event** is a set of sample outcomes; that is, a subset of the sample space $\Omega$. Events are often given letters like $A$, $B$, $C$. We write $A \subset \Omega$ to mean that $A$ is an event in (or, equivalently, is a subset of) the sample space $\Omega$.

This will be easier to understand with some concrete examples. We write a set (such as a sample space or an event) by writing all the elements of that set inside curly brackets $\{\ \}$, separated by commas.

::: {.example}
Suppose we toss a (possibly biased) coin, and record whether it lands heads or tails. Then our sample space is $\Omega = \{\mathrm H, \mathrm T\}$, where the sample outcome H denotes heads and the sample outcome T denotes tails.

The event that the coin lands heads is $\{\mathrm H\}$.
:::

::: {.example}
Suppose we roll a dice, and record the number rolled. Then our sample space is $\Omega = \{1,2,3,4,5,6\}$, where the sample outcome $1$ corresponds to rolling a one, and so on.

The event "we roll an even number" is $\{2,4,6\}$. The event "we roll at least a five" is $\{5,6\}$.
:::

::: {.example}
Suppose we wish to count how many claims are made to an insurance company in a year. We could model this by taking the sample space $\Omega$ to be $\mathbb Z_+ = \{0, 1, 2, \dots\}$, the set of all non-negative integers.

The event "the company receives less than 1000 claims" is $\{0, 1, 2, \dots, 998, 999\}$.
:::

::: {.example}
Suppose we want a computer to pick a random number between 0 and 1. We could model this by taking the sample space $\Omega$ to be the interval $[0, 1]$ of all real numbers between 0 and 1.

The event "the number is bigger than $\frac12$" is the sub-interval $(\frac12, 1]$ of all real numbers greater than $\frac12$ but no bigger than 1. The event "the first digit is a 7" is the sub-interval $[0.7, 0.8)$. The event "the random number is exactly $1/\sqrt{2}$" is $\{1/\sqrt{2}\}$.
:::

In the first two examples, the sample space $\Omega$ was finite. In third example, the sample space was infinite but "countably infinite", in that it could be counted using the discrete values of the positive integers. Both of these were for *counting* discrete observations. In the fourth example, the sample space was infinite but "uncountably infinite", in that it had a sliding scale or "continuum" of gradually varying measurements. This was for *measuring* continuous observations. This distinction will be important later in the course.

For any sample space $\Omega$, there are two special events that always exist. There's $\Omega$ itself, the event containing all of the sample outcomes, which represents "something happens". There's also the empty set $\varnothing$, which contains none of the sample outcomes, which represents "nothing happens". Common sense suggests that $\Omega$ should have probability 1, because *something* is bound to happen -- this will later be one of our probability "axioms". Common sense also suggests that $\varnothing$ should have probability 0, because it can't be that *nothing* happens -- this will not be one probability axioms, but we'll show that it follows logically from the axioms we do choose.


## Set theory  {#set-theory}

Since we've now defined events as being sets -- specifically, subsets of the sample space $\Omega$ -- it will be useful to mention a little set basic theory here.

First, there are ways we can build new sets (or events) out of old. It's fine to just read the words and look at the pictures for these definitions, but those who want to read the equations too will need to know this:

* $\omega \in A$ means "$\omega$ is in $A$" or "$\omega$ is an element of $A$", while $\omega \not\in A$ means the opposite, that $\omega$ is *not* in $A$;
* a colon $:$ in the middle of set notation should be read as "such that";
* so $\{\omega \in \Omega : \text{fact about $\omega$}\}$ should be read as "the set of sample outcomes $\omega$ in the sample space $\Omega$ such that the fact is true".

::::: {.definition}
Consider a sample space $\Omega$, and let $A$ and $B$ be events in that sample space.

:::: {style="display: flex;"}
::: {}
* **<span style="color: blue;">NOT:</span>** The **complement** of $A$, written $A^\comp$ (and said "$A$ complement" or "not $A$"), is the set of sample outcomes not in $A$; that is
\[ A^\comp = \{\omega \in \Omega : \omega \not\in A \} . \]
This represents the event that $A$ does not occur.
* **<span style="color: green;">AND</span>:** The **intersection** of $A$ and $B$, written $A \cap B$ (and said "$A$ intersect $B$" or "$A$ and $B$") is the set of sample outcomess in both $A$ and $B$; that is,
\
\[ A \cap B = \{\omega \in \Omega : \omega \in A \text{ and } \omega \in B \} . \]
This represents the event that both $A$ and $B$ occur.
* **<span style="color: red;">OR:</span>** The **union** of $A$ and $B$, written $A \cup B$ (and said "$A$ union $B$" or "$A$ or $B$") is the set of sample outcomess in $A$ or in $B$; that is,
\[ A \cup B = \{\omega \in \Omega : \omega \in A \text{ or } \omega \in B \} . \]
This represents the event that $A$ occurs or $B$ occurs. (In mathematics, "or" includes "both", so a sample outcome in both $A$ and $B$ is in $A\cup B$ too.)
:::

::: {}
\ 
:::

::: {}
```{tikz venn-not, echo=FALSE, fig.align="center", out.width="550pt", cache = TRUE}
\begin{tikzpicture}[line width=0.25pt, scale=0.8]

\begin{scope} 
	\fill  [blue!25] rectangle (6,4);
\end{scope}

\begin{scope} 
	\clip rectangle (6,4); 
	\fill  [white] (3,2) circle (1.5); 
\end{scope}

\draw[thick] (0,0) rectangle (6,4);
\draw (3,2) circle (1.5); \draw (3,2) node {$A$};
\draw (6.3,3.8) node {$\Omega$};
\draw (1,3.2) node {$A^{\mathsf{c}}$};
\end{tikzpicture}
```

```{tikz venn-and, echo=FALSE, fig.align="center", out.width="550pt", cache = TRUE}
\begin{tikzpicture}[line width=0.25pt, scale=0.8]
\begin{scope} 
	\clip (4,2) circle (1.5); 
	\fill  [green!25] (2,2) circle (1.5); 
\end{scope}

\draw[thick] (0,0) rectangle (6,4);
\draw (6.3,3.8) node {$\Omega$};
\draw (2,2) circle (1.5); \draw (1.6,2.0) node {$A$};
\draw (4,2) circle (1.5); \draw (4.4,2.0) node {$B$};

\end{tikzpicture}
```

```{tikz venn-or, echo=FALSE, fig.align="center", out.width="550pt", cache = TRUE}
\begin{tikzpicture}[line width=0.25pt, scale=0.8]

\begin{scope} 
	\fill  [red!25] (2,2) circle (1.5); 
	\fill  [red!25] (4,2) circle (1.5); 
\end{scope}

\draw[thick] (0,0) rectangle (6,4);
\draw (6.3,3.8) node {$\Omega$};
\draw (2,2) circle (1.5); \draw (1.6,2.0) node {$A$};
\draw (4,2) circle (1.5); \draw (4.4,2.0) node {$B$};

\end{tikzpicture}
```
:::
::::
:::::

::: {.example}
Suppose we are rolling a dice, so our sample space is $\Omega = \{1,2,3,4,5,6\}$. Let $A = \{2,4,6\}$ be the event that we roll and even number, and let $B = \{5,6\}$ be the event that we roll at least a 5. Then
\begin{align*}
A^\comp &= \{1,3,5\} = \{\text{roll an odd number}\} ,\\
A \cap B &= \{6\} = \{\text{roll a 6}\} ,\\
A \cup B &= \{2,4,5,6\} .
\end{align*}
:::

An important case is when two events $A, B$ cannot happen at the same time; that is, $A \cap B = \varnothing$ ("$A$ intersect $B$ is the empty set"). In this case, we say that $A$ and $B$ are **disjoint** or **mutually exclusive**. For example, when $\Omega$ is [a deck of cards](https://en.wikipedia.org/wiki/Standard_52-card_deck), then $A = \{\text{the card is a spade}\}$ and $B = \{\text{the card is red}\}$ are disjoint, because a card cannot be both a spade (a black suit) and red.

You might think that if two events are disjoint, then it would be reasonable to find the probability of their union -- that is, the probability that one (and, by necessity, only one) of them happens -- you can just add the two separate probabilities together. This will be another of our "axioms" of probability.

There are a few rules about ways you can combine the complement, intersection and union operations. These are ways of building new events from old. 

* The **double complement law** tells us that not-not-$A$ is the same as $A$:
\[ (A^\comp)^\comp = A .\]
This says that if it's not "not-raining", then it's raining!
* The **distributive laws** tells us we can "multiply out of the brackets" with sets:
\begin{align*}
  A \cap (B \cup C) &= (A \cap B) \cup (A \cap C) ,\\
  A \cup (B \cap C) &= (A \cup B) \cap (A \cup C) .
\end{align*}
The first says that if you are eating a burger with fries or salad, then you're eating a burger with fries or eating a burger with salad. The second is a bit less intuitive, I find, but it's clear that if $A$ is true then the first of each of the terms on the right is true, while if both $B$ and $C$ are true then the second of each of the terms on the right is true.
* **De Morgan's laws** tell us how complements interact with intersection/unions:
\begin{align*}
  (A \cap B)^\comp &= A^\comp \cup B^\comp \\
  (A \cup B)^\comp &= A^\comp \cap B^\comp
\end{align*}
The first of these says that if it's not a Monday in October, then either it's not Monday or it's not October (or both). The second says that if a maths lecture is not "useful or fun", then it's not useful and it's not fun. ([Augustus De Morgan](https://mathshistory.st-andrews.ac.uk/Biographies/De_Morgan/) was a British mathematician of the 19th century who did important work in logic.)

For this module, these mostly count as "common sense" -- but if you ever do need to prove one of these statements (or a similar one), one way is to use a Venn diagram.

Let's prove the second distributive law,
\[   A \cup (B \cap C) = (A \cup B) \cap (A \cup C) , \]
with a Venn diagram as an example.

We can build the left-hand side of the law as:

::: {style="display: flex;"}

::: {}
```{tikz dist1, echo=FALSE, fig.align="center", out.width="100%", cache = TRUE}

\usetikzlibrary{patterns}

\begin{tikzpicture}[line width=0.25pt, scale=0.7]

\draw[pattern=north west lines, pattern color=orange] (3.5,4) circle (1.5);  

\draw[thick] (0,0) rectangle (7,6);
\draw (2.5,2) circle (1.5); \draw (2.3,1.8) node {$B$};
\draw (4.5,2) circle (1.5); \draw (4.7,1.8) node {$C$};
\draw (3.5,4) circle (1.5); \draw (3.5,4.2) node {$A$};
\end{tikzpicture}
```
:::

::: {}
\ 
:::

::: {}
```{tikz dist2, echo=FALSE, fig.align="center", out.width="100%", cache = TRUE}
\usetikzlibrary{patterns}

\begin{tikzpicture}[line width=0.25pt, scale=0.7]

%\draw[pattern=north west lines, pattern color=blue] (2.5,2) circle (1.5); 
 %\draw[pattern=north east lines, pattern color=red] (4.5,2) circle (1.5); 
 
 \begin{scope} 
	\clip (2.5,2) circle (1.5); 
	\fill [pattern=north east lines, pattern color=purple] (4.5,2) circle (1.5); 
\end{scope}

\draw[thick] (0,0) rectangle (7,6);
\draw (2.5,2) circle (1.5); \draw (2.3,1.8) node {$B$};
\draw (4.5,2) circle (1.5); \draw (4.7,1.8) node {$C$};
\draw (3.5,4) circle (1.5); \draw (3.5,4.2) node {$A$};
\end{tikzpicture}
```
:::

::: {}
\ 
:::

::: {}
```{tikz dist3, echo=FALSE, fig.align="center", out.width="100%", cache = TRUE}
\usetikzlibrary{patterns}

\begin{tikzpicture}[line width=0.25pt, scale=0.7]

\begin{scope} 
	\fill  [gray!25] (3.5,4) circle (1.5); 
\end{scope}
%
\begin{scope} 
	\clip (4.5,2) circle (1.5); 
	\fill  [gray!25] (2.5,2) circle (1.5); 
\end{scope}

\draw[thick] (0,0) rectangle (7,6);
\draw (2.5,2) circle (1.5); \draw (2.3,1.8) node {$B$};
\draw (4.5,2) circle (1.5); \draw (4.7,1.8) node {$C$};
\draw (3.5,4) circle (1.5); \draw (3.5,4.2) node {$A$};
\end{tikzpicture}
```
:::

::::

The left-hand figure is $\color{orange}{A}$, the middle figure is $\color{purple}{B\cap C}$, and the right-hand figure is union of these, $A\cup (B\cap C)$.

Then for the right-hand side of the law, we have:

:::: {style="display: flex;"}

::: {}
```{tikz dist4, echo=FALSE, fig.align="center", out.width="100%", cache = TRUE}
\usetikzlibrary{patterns}

\begin{tikzpicture}[line width=0.25pt, scale=0.7]

\draw[pattern=north east lines, pattern color=blue] (2.5,2) circle (1.5); 
 
\draw[pattern=north west lines, pattern color=orange] (3.5,4) circle (1.5); 

\draw[thick] (0,0) rectangle (7,6);
\draw (2.5,2) circle (1.5); \draw (2.3,1.8) node {$B$};
\draw (4.5,2) circle (1.5); \draw (4.7,1.8) node {$C$};
\draw (3.5,4) circle (1.5); \draw (3.5,4.2) node {$A$};
\end{tikzpicture}
```
:::

::: {}
\ 
:::

::: {}
```{tikz dist5, echo=FALSE, fig.align="center", out.width="100%", cache = TRUE}
\usetikzlibrary{patterns}

\begin{tikzpicture}[line width=0.25pt, scale=0.7]

\draw[pattern=north west lines, pattern color=orange] (3.5,4) circle (1.5);  

\draw[pattern=north east lines, pattern color=red] (4.5,2) circle (1.5); 

\draw[thick] (0,0) rectangle (7,6);
\draw (2.5,2) circle (1.5); \draw (2.3,1.8) node {$B$};
\draw (4.5,2) circle (1.5); \draw (4.7,1.8) node {$C$};
\draw (3.5,4) circle (1.5); \draw (3.5,4.2) node {$A$};
\end{tikzpicture}
```
:::

::: {}
\ 
:::

::: {}
```{tikz dist6, echo=FALSE, fig.align="center", out.width="100%", cache = TRUE}
\usetikzlibrary{patterns}

\begin{tikzpicture}[line width=0.25pt, scale=0.7]

\begin{scope} 
	\fill  [gray!25] (3.5,4) circle (1.5); 
\end{scope}
%
\begin{scope} 
	\clip (4.5,2) circle (1.5); 
	\fill  [gray!25] (2.5,2) circle (1.5); 
\end{scope}

\draw[thick] (0,0) rectangle (7,6);
\draw (2.5,2) circle (1.5); \draw (2.3,1.8) node {$B$};
\draw (4.5,2) circle (1.5); \draw (4.7,1.8) node {$C$};
\draw (3.5,4) circle (1.5); \draw (3.5,4.2) node {$A$};
\end{tikzpicture}
```
:::

::::

The left-hand figure is $\color{orange}{A} \cup \color{blue}{B}$, the middle figure is $\color{orange}{A}\cup \color{red}{C}$, and the right-hand figure is intersection of these, $(A\cup B)\cap (A\cup C)$.

We see that the areas shaded in two right-hand figures are the same, so it is indeed the case that
$A\cup (B\cap C) = (A\cup B)\cap (A\cup C)$.






<!-- REALLY DELETE THIS!!!!!!!!!!





Let's also prove the first of De Morgan's laws, 
  \[ (A \cap B)^\comp = A^\comp \cup B^\comp , \]
this time using a truth table. (This bit might be more clear from the video above, from 14:30.) We start with a table like this, with the four possibilities of whether $A$ and/or $B$ are true:

| $A$ | $B$ | $A\cap B$ | $(A \cap B)^\comp$ | $A^\comp$ | $B^\comp$ | $A^\comp \cup B^\comp$ |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| False | False |  |  |  |  |  |
| False | True |  |  |  |  |  |
| True | False |  |  |  |  |  |
| True | True |  |  |  |  |  |

We fill in the first half to find a column for the left-hand side of the law $(A \cap B)^\comp$:

| $A$ | $B$ | $A\cap B$ | $(A \cap B)^\comp$ | $A^\comp$ | $B^\comp$ | $A^\comp \cup B^\comp$ |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| False | False | False | **True** |  |  |  |
| False | True | False | **True** |  |  |  |
| True | False | False | **True** |  |  |  |
| True | True | True | **False** |  |  |  |
and the second half to find a column for the right-hand side of the law $A^\comp \cup B^\comp$.

| $A$ | $B$ | $A\cap B$ | $(A \cap B)^\comp$ | $A^\comp$ | $B^\comp$ | $A^\comp \cup B^\comp$ |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| False | False | False | **True** | True | True | **True** |
| False | True | False | **True** | True | False | **True** |
| True | False | False | **True** | False | True | **True** |
| True | True | True | **False** | False | False | **False** |
Since the $(A \cap B)^\comp$ column and the $A^\comp \cup B^\comp$ column are the same, these must be the same sets.

-->  


## Summary  {#summary-L03 .unnumbered}

::: {.mysummary}
* A sample space $\Omega$ is a set representing all possible sample outcomes.
* An event is a subset of $\Omega$.
* For events $A$ and $B$, we also have the complement "not $A$" $A^\comp$, the intersection "$A$ and $B$" $A \cap B$, and the union "$A$ or $B$" $A \cup B$.
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Sections 1.1 and 1.2 (plus optionally Chapter 0).
* [Grimmett and Welsh, *Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991002938669705181), Sections 1.1 and 1.2.

<!--chapter:end:sections/L03-events.Rmd-->

# Probability  {#L04-probability}



## Probability axioms  {#axioms}


Recall that, in this mathematics course, the probability of an event will be a real number that satisfies certain properties, which we call **axioms**.

::: {.definition #axioms}
Let $\Omega$ be a sample space. A **probability measure** on $\Omega$ is a function $\mathbb P$ that assigns to each event $A \subset \Omega$ a real number $\mathbb P(A)$, called the **probability** of $A$, and that satisfies the following three axioms:

1. $\mathbb P(A) \geq 0$ for all events $A \subset \Omega$;
1. $\mathbb P(\Omega) = 1$;
1. if $A_1, A_2, \dots$ is a finite or infinite sequence of disjoint events, then
\[ \mathbb P(A_1 \cup A_2 \cup \cdots) = \mathbb P(A_1) + \mathbb P(A_2) + \cdots . \]

The sample space $\Omega$ together with the probability measure $\mathbb P$ are called a **probability space**.
:::

Axiom 1 says that all probabilities are non-negative numbers. Axiom 2 says the probability that *something* happens is 1. Axiom 3 is about *disjoint* events -- recall that these are events where no two can happen at the same time, because the intersection of any pair of them is empty. [***Correction:** In the 3pm lecture, I wrongly said that their* union *is empty.*] Axiom 3 says that for disjoint events the probability that one of them happens is the sum of the individual probabilities. (Those who like their mathematical statements very precise should note that an infinite sequence in Axiom 3 must be "countable"; that is, indexed by the natural numbers $1, 2, 3, \dots$.)

These axioms of probability (and our later results that follow from them) were first written down by the Russian mathematician [Andrey Nikolaevich Kolmogorov](https://mathshistory.st-andrews.ac.uk/Biographies/Kolmogorov/) in 1933. This marked the point from when probability theory could now be considered a proper branch of mathematics -- just as legitimate as geometry or number theory -- and not just a past-time that can be useful to help gamblers calculate their odds. I always find it surprising that the axioms of probability are only 90 years old!

There are other properties that it seems natural that a probability measure should have aside from the axioms -- for example, that $\mathbb P(A) \leq 1$ for all events $A$. But we will show shortly that other properties can be proven just by starting from the three axioms.

But first, let's see some examples.

::: {.example}
Suppose we wish to model tossing an biased coin the is heads with probability $p$, where $0 \leq p \leq 1$.

Our probability space is $\Omega = \{\text{H}, \text{T}\}$. The probability measure is given by
\begin{align*}
   \mathbb P(\varnothing) &= 0  &  \mathbb P(\{\text{H}\}) &= p \\
   \mathbb P(\{\text{T}\}) &= 1 - p  &  \mathbb P(\{\text{H},\text{T}\})  &= 1 .
\end{align*}

Let's check that the axioms hold:

1. Since $0 \leq p \leq 1$, all the probabilities are greater than or equal to 0.
1. It is indeed the case that $\mathbb P(\Omega) = \mathbb P(\{\text{H},\text{T}\}) = 1$.
1. The only nontrivial disjoint union to check is $\{\text{H}\} \cup \{\text{T}\} = \{\text{H},\text{T}\}$, where we see that
\[ \mathbb P(\{\text{H}\}) + \mathbb P(\{\text{T}\}) = p + (1 - p) = 1 = \mathbb P(\{\text{H},\text{T}\}) , \]
as required.
:::

::: {.example}
Suppose we wish to model rolling a dice.

Our sample space is $\{1,2,3,4,5,6\}$. The probability measure is given by
\[ \mathbb P(A) = \frac{|A|}{6} , \]
where $|A|$ is the number of sample outcomes in $A$.

So, for example, the probability of rolling an even number is 
\[ \mathbb P(\{2,4,6\}) = \frac36 = \frac12 . \]
:::

The dice rolling is a particular case of the "classical probability" of equally likely outcomes. We'll look at this more in the next lecture, and prove that the classical probability measure does indeed satisfy the axioms


## Properties of probability {#prob-properties}



The axioms of Definition \@ref(def:axioms) only gave us some of the properties that we would like a probability measure to have. Our task now (in this subsection and the next) is to carefully prove how these other properties follow from just those axioms. In particular, we're not allowed to make claims that merely "seem likely to be true" or "are common sense" -- we can only use the three axioms together with strict logical deductions and nothing else.

::: {.theorem}
Let $\Omega$ be a sample space with a probability measure $\mathbb P$. Then we have the following:

1. $\mathbb P(\varnothing) = 0$.
1. $\mathbb P(A^\comp) = 1 - \mathbb P(A)$ for all events $A \subset \Omega$.
1. For events $A$ and $B$ with $B \subset A$, we have $\mathbb P(B) \leq \mathbb P(A)$.
1. $0 \leq \mathbb P(A) \leq 1$ for all events $A \subset \Omega$.
:::

Importantly, the second result here tells us how to deal with complements or "not" events: the probability of $A$ *not* happening is 1 minus the probability it does happen. This is often very useful.

::: {.proof}
The key with most of these "prove from the axioms" problems is to think of a way to write the relevant events as part of a *disjoint* union, then use Axiom 3. Statements 1 and 2 are exercises for you on [Problem Sheet 2](#P2). We'll start with the third statement.

Here, since $B$ is a subset of $A$, meaning that $B$ is entirely inside $A$. 

```{tikz subs0, echo=FALSE, fig.align="center", out.width="320pt", cache = TRUE}
\begin{tikzpicture}[line width=0.25pt, scale=0.8]

\draw[thick] (0,0) rectangle (6,4);
\draw (6.3,3.8) node {$\Omega$};

\draw (3.5,1.5) circle (0.5); \draw (3.5,1.5) node {$B$};
\draw (3,2) circle (1.5); \draw (2.7,2.5) node {$A$};
\end{tikzpicture}
```

It would be useful to write $A$ as a *disjoint* union of $\color{orange}B$ and <span style="color: purple;">"the bit of $A$ that isn't in $B$"</span>. That is, we have the disjoint union
\[ A = \color{orange}B \cup (\color{purple}{A \cap B^\comp}) .\]

```{tikz subs, echo=FALSE, fig.align="center", out.width="320pt", cache = TRUE}
\begin{tikzpicture}[line width=0.25pt, scale=0.8]

\draw[thick] (0,0) rectangle (6,4);
\draw (6.3,3.8) node {$\Omega$};

\fill  [purple!25] (3,2) circle (1.5); 
\fill  [orange!25] (3.5,1.5) circle (0.5); 

\draw (3.5,1.5) circle (0.5); \draw (3.5,1.5) node {$B$};
\draw (3,2) circle (1.5); \draw (2.7,2.5) node {$A$};
\end{tikzpicture}
```

Applying Axiom 3 to this disjoint union gives
\[ \mathbb P(A) =  \mathbb P(\color{orange}B) + \mathbb P(\color{purple}{A \cap B^\comp}) . \]

We're happy to see the term on the left-hand side and the first term on the right-hand side. But what about the awkward $\mathbb P(A \cap B^\comp)$? Well, by Axiom 1, we know that the probability of any event is greater than or equal to 0, so in particular. $\mathbb P(A \cap B^\comp) \geq 0$. Hence
\[ \mathbb P(A)  \geq \mathbb P(B) + 0 = \mathbb P(B) , \]
and we are done with the third statement.

For the fourth statement, we have $\mathbb P(A) \geq 0$ directly from Axiom 1, so only need to show that $\mathbb P(A) \leq 1$. We can do this using the third statement of this theorem. For any event $A$ we have $A \subset \Omega$, so the third statement tells us that $\mathbb P(A) \leq \mathbb P(\Omega)$. But Axiom 2 tells us that $\mathbb P(\Omega) = 1$, so $\mathbb P(A) \leq 1$ and we are done.
:::


## Addition rules for unions  {#addition}


If we have two or more events, we'd like to work out the probability of their union; that is, the probability that at least one of them occurs.

We already have an addition rule for *disjoint* unions.

::: {.theorem}
Let $A, B \subset \Omega$ be two disjoint events. Then
\[ \mathbb P(A \cup B) = \mathbb P(A) + \mathbb P(B) . \]
:::

::: {.proof}
In Axiom 3, take the finite sequence $A_1 = A$, $A_2 = B$.
:::

But what about if $A$ and $B$ are not disjoint? Then we have the following.

::: {.theorem}
Let $A, B \subset \Omega$ be two events. Then
\[ \mathbb P(A \cup B) = \mathbb P(A) + \mathbb P(B) - \mathbb P(A \cap B) . \]
:::

You may have seen this result before. You've perhaps justified it by saying something like this: "We can add the two probabilities together, except now we've double-counted the overlap, so we have to take the probability of that away." Maybe you drew a Venn diagram. That's OK as a way to remember the result -- but this is a proper university mathematics course, so we have to carefully *prove* it starting from just the axioms and nothing else.

::: {.proof}
The problem here is that $A$ and $B$ are not (in general) disjoint, so we can't apply Axiom 3.

```{tikz add3, echo=FALSE, fig.align="center", out.width="320pt", cache = TRUE}
\begin{tikzpicture}[line width=0.25pt, scale=0.8]


\draw[thick] (0,0) rectangle (6,4);
\draw (6.3,3.8) node {$\Omega$};
\draw (2,2) circle (1.5); \draw (1.6,2.0) node {$A$};
\draw (4,2) circle (1.5); \draw (4.4,2.0) node {$B$};
\end{tikzpicture}
```

Instead, let's split this up into the three disjoint bits: <span style="color: red;">"$A$ but not $B$"</span> $\color{red}{A \cap B^\comp}$, <span style="color: blue;">"$B$ but not $A$"</span> $\color{blue}{B \cap A^\comp}$, and <span style="color: green;">"both"</span> $\color{green}{A \cap B}$.

```{tikz add4, echo=FALSE, fig.align="center", out.width="320pt", cache = TRUE}
\begin{tikzpicture}[line width=0.25pt, scale=0.8]

\fill  [red!25] (2,2) circle (1.5);
\fill  [blue!25] (4,2) circle (1.5); 

\begin{scope} 
	\clip (2,2) circle (1.5);
	\fill  [green!25] (4,2) circle (1.5); 
\end{scope}


\draw[thick] (0,0) rectangle (6,4);
\draw (6.3,3.8) node {$\Omega$};
\draw (2,2) circle (1.5); \draw (1.6,2.0) node {$A$};
\draw (4,2) circle (1.5); \draw (4.4,2.0) node {$B$};
\end{tikzpicture}
```

Now we can write $A$, $B$ and $A \cup B$ in terms of these disjoint bits.
\begin{align}
A &= (\color{red}{A \cap B^\mathsf{c}}) \cup (\color{green}{A \cap B}) \\
B &= (\color{blue}{B \cap A^\mathsf{c}}) \cup (\color{green}{A \cap B}) \\
A \cup B &= (\color{red}{A \cap B^\mathsf{c}}) \cup (\color{blue}{B \cap A^\mathsf{c}}) \cup (\color{green}{A \cap B}),
\end{align}
with all the unions on the right-hand side being disjoint. Applying Axiom 3 to them all gives
\begin{align}
\mathbb P(A) &= \mathbb P(\color{red}{A \cap B^\comp}) + \mathbb P(\color{green}{A \cap B}) (\#eq:un1)  \\
\mathbb P(B) &= \mathbb P(\color{blue}{B \cap A^\mathsf{c}}) + \mathbb P(\color{green}{A \cap B})  (\#eq:un2) \\
\mathbb P(A \cup B) &= \mathbb P(\color{red}{A \cap B^\comp}) + \mathbb P(\color{blue}{B \cap A^\mathsf{c}}) + \mathbb P(\color{green}{A \cap B}) . (\#eq:un3)
\end{align}
Here, \@ref(eq:un3) is looking good, but we need to get rid of the awkward $\mathbb P(\color{red}{A \cap B^\comp})$ and $\mathbb P(\color{blue}{B \cap A^\mathsf{c}})$ terms. We can do that be rearranging \@ref(eq:un1) and \@ref(eq:un2) to get
\begin{align}
\mathbb P(\color{red}{A \cap B^\comp}) &= \mathbb P(A) - \mathbb P(\color{green}{A \cap B}) \\
\mathbb P(\color{blue}{B \cap A^\mathsf{c}}) &= \mathbb P(B) - \mathbb P(\color{green}{A \cap B}) .
\end{align}
Substituting these into \@ref(eq:un3) gives
\begin{align}
\mathbb P(A \cup B) &= \mathbb P(A) - \mathbb P(\color{green}{A \cap B}) + \mathbb P(B) - \mathbb P(\color{green}{A \cap B}) + \mathbb P(\color{green}{A \cap B}) \\
  &= \mathbb P(A)+ \mathbb P(B) - \mathbb P(A \cap B) ,
\end{align}
as required.
:::



::: {.example}
*Consider picking a card from a [standard 52-card deck](https://en.wikipedia.org/wiki/Standard_52-card_deck) at random, with $\mathbb P(A) = |A|/52$. What's the probability the card is a spade or an ace?*

It is possible to just to work this out directly. But let's use our addition law for unions.

We have $\mathbb P(\text{spade}) = \frac{13}{52}$ and $\mathbb P(\text{ace}) = \frac{4}{52}$. So we have
\[ \mathbb P(\text{spade or ace}) = \tfrac{13}{52} + \tfrac{4}{52} - \mathbb P(\text{spade and ace}) . \]
But $\mathbb P(\text{spade and ace})$ is the probability of picking the ace of spades, which is $\frac{1}{52}$. Therefore
\[ \mathbb P(\text{spade or ace}) = \tfrac{13}{52} + \tfrac{4}{52}  - \tfrac{1}{52} = \tfrac{16}{52} = \tfrac{4}{13} . \]
:::



## Summary  {#summary-L04 .unnumbered}

::: {.mysummary}
* The axioms of probability are (1) $\mathbb P(A) \geq 0$; (2) $\mathbb P(\Omega) = 1$; and (3) that for disjoint events $A_1, A_2, \dots$, we have $\mathbb P(A_1 \cup A_2 \cup \cdots) = \mathbb P(A_1) + \mathbb P(A_2) + \cdots$.
* Other properties can be proven from these axioms, like the complement rule $\mathbb P(A^\comp) = 1 - \mathbb P(A)$, and the addition rule for unions $\mathbb P(A \cup B) = \mathbb P(A) + \mathbb P(B) - \mathbb P(A \cap B)$.
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Sections 1.3 and 1.4.
* [Grimmett and Welsh, *Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991002938669705181), Sections 1.3 and 1.4.
* My blogpost ["How to prove the addition rule for unions"](https://mpaldridge.github.io/blog/union.html)

On [Problem Sheet 2](#P2), you should now be able to complete Questions A1, A2, B1, B2 and perhaps C1.

<!--chapter:end:sections/L04-probability.Rmd-->

# Classical probability I  {#L05-classical-i}


## Probability with equally likely outcomes {#classical-intro}

**Classical probability** is the name we give to probability where there are a finite number of equally likely outcomes.

Classical probability was the first type of probability to be formally studied -- partly because it is the simplest, and partly because it was useful for working out how to win at gambling. Tossing fair coins, rolling dice, and dealing cards are all common gambling situations that can be studied using classical probability -- in a deck of cards, for example, there are 52 cards that are equally likely to be drawn. Among the first works to seriously study classical probability were "Book on Games of Chance" by [Girolamo Cardano](https://mathshistory.st-andrews.ac.uk/Biographies/Cardan/) (written in 1564, but not published until 1663, one hundred years later), and a famous series of letters between [Blaise Pascal](https://mathshistory.st-andrews.ac.uk/Biographies/Pascal/) and [Pierre de Fermat](https://mathshistory.st-andrews.ac.uk/Biographies/Fermat/) in 1654.

::: {.definition}
Let $\Omega$ be a finite sample space. Then the **classical probability measure** on $\Omega$ is given by
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} . \]
:::

So to work out a classical probability $\mathbb P(A)$, crucially we need to be able to count how many outcomes $|A|$ are in the event $A$ and count how many outcomes $|\Omega|$ are in the whole sample space $\Omega$. (This is why classical probability is also called "enumerative probability" -- "enumeration" is another word for counting.) In this lecture and the next, we'll look at some different ways in which we can count the number of outcomes in common events and sample spaces.

::: {.example}
*We roll a dice. What is the probability we get at least 5?*

The sample space is $\Omega = \{1,2,3,4,5,6\}$, with $|\Omega| = 6$. The event that we roll at least 5 is $A = \{5,6\}$, with $|A| = 2$. Hence
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{2}{6} = \frac{1}{3} . \]
:::

There's something we ought to check before going any further!

::: {.theorem}
Let $\Omega$ be a finite nonempty sample space. Then the classical probability measure on $\Omega$,
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} , \]
is indeed a probability measure, in that it satisfies the three axioms in Definition \@ref(def:axioms).
:::

::: {.proof}
We'll take the axioms one by one.

1. Since $|\Omega| \geq 1$ and $|A| \geq 0$, it is indeed the case that $\mathbb P(A) = |A|/|\Omega| \geq 0$.
2. We have ${\displaystyle \mathbb P(\Omega) = \frac{|\Omega|}{|\Omega|} = 1}$, as required.
3. Since we have a finite sample space, we only need to show Axiom 3 for a sequence of two disjoint events; the argument can be repeated to get any finite number of events. Let $A = \{a_1, a_2, \dots, a_k\}$ and $B = \{b_1, b_2, \dots, b_l\}$ be two disjoint events with $|A| = k$ and $|B| = l$. Note that we can enumerate the elements of the disjoint union $C = A \cup B$ as
\[ c_1 = a_1, c_2 = a_2, \dots, c_k = a_k, c_{k+1} = b_1, c_{k+2} = b_2, \dots, c_{k+l} = b_l . \]
Since $A$ and $B$ are disjoint, this list has no repeats, and we see that $|C| = |A \cup B| = k+l$. Hence
\[ \mathbb P(A \cup B) = \frac{k+l}{|\Omega|} = \frac{k}{|\Omega|} + \frac{l}{|\Omega|} = \mathbb P(A) + \mathbb P(B) , \]
and Axiom 3 is fulfilled.
:::






## Multiplication principle  {#multiplication}


In classical probability, to find the probability of an event $A$, we need to count the number of outcomes in $A$ and the total number of possible outcomes in $\Omega$. This can be easy when we're just looking at one choice -- like the 2 outcomes from tossing a single coin, the 6 outcomes of rolling a single dice, or the 52 outcomes from dealing a single card. Now we're going to look at what happens if there are a number of choices one after another -- like tossing multiple coins, rolling more than one dice, or dealing a hand of cards.

Here, an important principle is the **multiplication principle**. The multiplication principle says that if you have $n$ choices followed by $m$ choices, than all together you have $n \times m$ total choices. You can see this by imagining the choices in a $n \times m$ grid, with the $n$ columns representing the first choice and $m$ rows representing the second choice. For example, suppose you go to a burger restaurant where there are 3 choices of burger (beefburger, chicken burger, veggie burger) and 2 choices of sides (fries, salad), then altogether there are $3 \times 2 = 6$ choices of meal.

|  | Beefburger | Chicken burger | Veggie burger |
|:-:|:-:|:-:|:-:|
| **Fries** | 1: Beefburger with fries | 2: Chicken burger with fries | 3: Veggie burger with fries |
| **Salad** | 4: Beefburger with salad | 5: Chicken burger with salad | 6: Veggie burger with salad |

More generally, if you have $m$ stages of choosing, with $n_1$ choices in the first stage, then $n_2$ choices in the second stage, all the way to $n_m$ choices in the final stage, you have $n_1 \times n_2 \times \cdots \times n_m$ total choices altogether.


::: {.example}
*Five fair coins are tossed. What is the probability they all show the same face?*

Here, the sample space $\Omega$ is the set of all sequences of 5 coin outcomes. How many sample outcomes are in $\Omega$? Well, the first coin can be heads or tails (2 choices); the second coin can be heads or tails (2 choices) and so on, until the fifth and final coin. So, by the multiplication principle, $|\Omega| = 2 \times 2 \times 2 \times 2 \times 2 = 2^5 = 32$.

The event we're interested in is $A = \{\text{HHHHH}, \text{TTTTT}\}$, the event that the faces are all the same -- either all heads or all tails. This clearly has $|A| = 2$ outcomes.

So the probability all five coins show the same face is
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{2}{32} = \frac{1}{16} \approx 0.06. \]
:::

::: {.example}
*Four dice are rolled. What is the probability we get at least one 6?*

Here, $\Omega$ is the set of all possible sequences of four dice rolls. Clearly $|\Omega| = 6^4 = 1296$.

The event $A$ is the set of all dice roll sequences with at least one 6. Whenever you see a question with the phrase "at least one" in it, it's very often a good idea to look at the complementary event $A^\comp$ instead. We know from [the last lecture](#prob-properties) that $\mathbb P(A) = 1 - \mathbb P(A^\comp)$, but in "at least one" questions, it's often easier to count $|A^\comp|$ than to count $|A|$.

Here, since $A$ is the set of all dice roll sequences with at least one 6, then $A^\comp$ is the set of dice roll sequence without any 6s at all. This means all four dice must have rolled a 1, 2, 3, 4 or 5. Since each of the four dice rolls has five possibilities, this means that $|A^\comp| = 5^4 = 625$.

Putting this together, we see that
\[ \mathbb P(A) = 1 - \mathbb P(A^\comp) = 1 - \frac{|A^\comp|}{|\Omega|} = 1 - \frac{625}{1296} = \frac{671}{1296} \approx 0.518 .\]
So there's about a 52% chance we get at least one 6.
:::




## Sampling with and without replacement  {#sampling}

Probabilists love problems where they pick coloured balls out of a bag!

::: {.example}
*A bag contains 15 balls: 10 black balls and 5 white balls. We draw 3 balls out of the bag. What is the probability all 3 balls are black **(a)** if we put each ball back into the bag after it is chosen; **(b)** if we do not put each ball back into the bag after it is chosen.*

Let's start with (a). The number of ways to choose a ball out 15 on three occasions is $|\Omega| = 15^3$. The number of ways to choose a black ball out of 10 on three occasions is $|A| = 10^3$. Hence 
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{10^3}{15^3} =  \frac{1000}{3375} = \frac{8}{27} \approx 0.30. \]

What about (b)? Here we don't put the ball back in the bag once it has been chosen. There are 15 ways to pick the first ball. But then there are only 14 balls left in the bag for the second choice, and only 13 balls for the third choice. So $|\Omega| = 15\times14\times13$. Similarly, there are 10 ways the first ball can be black. But once that black ball is removed, only 9 choices for the second black ball, and only 8 for the third. So $|A| = 10\times9\times8$. So this time we have
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{10\times9\times8}{15\times14\times13} =  \frac{720}{2730} = \frac{24}{91} \approx 0.26, \]
which is slightly smaller than the answer in part (a).
:::

This example illustrated the difference between **sampling with replacement** (when the balls were put back into the bag) and **sampling without replacement** (when the balls were not put back). If we want to sample $k$ items from a set of $n$ items, then:

* the number of ways to sample with replacement is
\[ n^k = n\times n\times\cdots\times n;  \]
* the number of ways to sample without replacement is
\[ \ff{n}{k} = n\times(n-1)\times \cdots\times (n-k+1) .\]

Here, we've defined the notation $\ff{n}{k}$ for the number of ways to sample without replacement; this is called the **falling factorial** or **permutation number**. This is still $k$ numbers multiplied together, but decreasing by 1 each time down from $n$. The final number in the product is the number of choices in the $k$th an final round: this is the original $n$ items minus the $k-1$ items sampled in the previous $k-1$ rounds; so the final number is $n - (k-1) = n - k + 1$. A notation point: Notice that the subscript is underlined in the falling factorial; other notation sometimes used includes $(n)_k$, $P(n,k)$, or ${}^nP_k$.

In our balls-in-a-bag problem, the answer for sampling with replacement was $10^3/15^3$, while the answer for sampling without replacement was $\ff{10}{3}/\ff{15}{3}$.

Next time, we will look at more classical probability problems. Do two of your friends share a birthday? Can you shuffle a deck of cards in an order that has never happened before in the history of the universe? And can you win the National Lottery?

## Summary  {#summary-L05 .unnumbered}

::: {.mysummary}
* "Classical probability" describes the situation where there are finitely many equally likely outcomes. The classical probability $\mathbb P(A) = |A|/|\Omega|$ requires us to count how many outcomes there are in events or sample spaces.
* The multiplication principle says that $n$ choices followed by $m$ choices makes $n \times m$ choices in total.
* Sampling $k$ objects out of $n$ with replacement gives $n^k$ choices.
* Sampling $k$ objects out of $n$ without replacement gives $n^{\underline{k}} = n(n-1)\cdots(n-k+1)$ choices.
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Sections 3.1 and 3.2.

<!--
::: {.example}
*Two dice are rolled. What is the probability of getting a total score of 8?*

Here, the sample space $\Omega$ is the set of all pairs of dice rolls
\[ \Omega = \big\{ (1,1), (1, 2), (1, 2), \dots, (6,5), (6,6) \big\} . \]
Note that all the outcomes are equally likely, so we have a classical probability problem.

Because there are 6 possible values for the first dice and 6 possible values for the second dice, by the multiplication principle we have $|\Omega| = 6 \times 6 = 36$.

Let $A$ be the event we roll a total of 8. We need to find $|A|$, the number of sample outcomes in $A$. We can find this simply by listing them all:
\[ A = \big\{ (2,6), (3, 5), (4, 4), (5,3), (6,2) \big\} .\]
We see that $|A| = 5$.

Hence, the probability of getting a total of 8 is
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{5}{36} \approx 0.14 .\]
:::
-->

<!--chapter:end:sections/L05-classical-i.Rmd-->

# Classical probability II  {#L06-classical-ii}



We continue looking at the classical probability $\mathbb P(A) = |A|/|\Omega|$, by looking at ways to enumerate $\Omega$ and $A$. Last time we saw:

* The multiplication principle: $n_1$ choices followed by $n_2$ choices, ..., up to $n_k$ choices gives $n_1 \times n_2 \times \cdots \times n_k$ choices in total.
* Sampling $k$ objects out of $n$ with replacement gives $n^k$ choices.
* Sampling $k$ objects out of $n$ without replacement gives $n^{\underline{k}} = n(n-1)\dots(n-k+1)$ choices.



## Ordering  {#ordering}



::: {.example}
*Suppose a lecturer marks a pile of $n$ exam papers, all of which receive a different mark. What is the probability she ends up marking them in order from lowest scoring first in the pile to highest scoring last in the pile?*

Here, the sample space $\Omega$ is the set of all orderings of the $n$ exam papers by mark, and $A$ is the event that the papers are in order from lowest to highest scoring. It's clear that $|A| = 1$: since the exams scored different marks, there's only one way of putting the exams in the correct lowest-to-highest order. But what's $|\Omega|$?

There are $n$ choices for the first exam paper to be marked. Then, for the second exam paper, there are $n - 1$ choices left, because the lecturer is not going to mark the same paper twice. There are $n-2$ choices for the third exam paper. And so on, until she has marked $n-1$ papers, and there is only 1 choice left for the final paper. So we have
\[ |\Omega| = \ff nn = n(n-1)(n-2)\cdots3\cdot2\cdot1 = n! \]
ways to order the exam papers.

Hence, the probability the papers are marked in order is
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{1}{n(n-1)\cdots2\cdot1} = \frac{1}{n!} . \]
:::

This number
\[ n! = \ff nn = n(n-1)(n-2)\cdots3\cdot2\cdot1 \]
is called **$n$ factorial** and denoted $n!$. It is the number of ways that $n$ different objects can be ordered.

The factorial $n!$ gets very large very quickly. **Stirling's formula** gives the approximation
$n! \approx \sqrt{2\pi n} \, \mathrm{e}^{-n} \, n^n$.

::: {.example}
Suppose you shuffle a pack of cards. The resulting ordering of the deck has $52!$ possibilities. This is an unimaginably huge number -- the exact value to 3 significant figures is
\[ 52! = 8.07 \times 10^{67} , \]
while Stirling's formula gives the approximation
\[ 52! \approx \sqrt{2\pi \times 52} \times \mathrm{e}^{-52} \times 52^{52} = 8.05 \times 10^{67} . \]
This is an 8 followed by 67 zeroes.

If every person on the planet (very roughly $10^{10}$) had shuffled a deck of cards one million ($10^6$) times a second for the entire lifetime of the universe (roughly $10^{17}$ seconds), they could only expect to have got through about $10^{33}$ shuffles.
This is only the most tiny, microscopic fraction of $52!$. So every time you have ever shuffled a deck of cards, it is essentially certain that you have created an ordering of the deck that has never existed before.
:::

If we take the ratio of a bigger factorial $n!$ over a smaller factorial $j!$, we get lot of cancellation,
\begin{align*}
\frac{n!}{j!} &= \frac{n(n-1) \cdots(j+1)j(j-1) \cdots 1}{j(j-1) \cdots 1} \\
  &= n(n-1) \cdots (j+1) ,
\end{align*}
because the last part of the product in the numerator cancels with the whole of the denominator. Replacing $j$ with $n-k$, this gives
\[ \frac{n!}{(n-k)!} = n(n-1) \cdots (n - k + 1) = \ff{n}{k} . \]
This gives a way of writing the falling factorial as the ratio of two (normal) factorials, which can sometimes be useful.



## Sampling without replacement in any order  {#combinations}



::: {.example #lotto}
*In the Lotto, the UK national lottery, you can buy a ticket for £2 and choose 6 numbers between 1 and 59. If your 6 numbers match the 6 numbers on the balls chosen by the lottery machine, you win the jackpot (usually between £2 million and £20 million, shared between the tickets that get all 6 numbers). If you buy a ticket, what is the probability you win the jackpot?*

Here, $\Omega$ is the set of all possible sets of 6 winning numbers, and $A$ is the set of numbers on your ticket. Clearly $|A| = 1$, but what is $|\Omega|$?

Well, the first ball out of the machine has 59 possibilities, the second ball has 58 possibilities, and so on, making
\[ 59 \times 58 \times 57 \times 56 \times 55 \times 54 = \ff{59}{6} . \]

But this isn't the correct answer, because the same set of balls could be drawn from the machine in any order! The sets of balls $\{1,2,3,4,5,6\}$ and $\{6,5,4,3,2,1\}$ and $\{1,3,5,6,4,2\}$ are all the same set of numbers. How many ways can we see the same list of numbers? This is precisely the number of orderings of 6 balls, which we know is $6!$. So the number of possible sets of 6 balls to come out of the machine is actually
\[ \binom{59}{6} = \frac{\ff{59}{6}}{6!} = \frac{59 \times 58 \times 57 \times 56 \times 55 \times 54}{6\times5\times4\times3\times2\times1} \approx 45 \text{ million} . \]

Thus the probability that your ticket wins the jackpot is
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{1}{\binom{59}{6}} \approx \frac{1}{45 \text{ million}} \approx 0.000\,000\,02 . \]
:::

Here, we have introduced the notation
\[ \binom{n}{k} = \frac{\ff{n}{k}}{k!} = \frac{n(n-1) \cdots (n-k+1)}{k(k-1)\cdots2\cdot1}  \]
for the number of ways to choose $k$ objects out of $n$ without replacement *and where the order they were chosen in doesn't matter*. This is called the **binomial coefficient**, although when we say it out loud we normally just say "$n$ choose $k$". (Another notation for the binomial coefficient is ${}^n C_k$.)

It can sometimes be useful to remember that $\ff nk = n!/(n-k)!$ allows us to write the binomial coefficient in terms of the factorial function as
\[ \binom nk = \frac{\ff nk}{(n-k)!} = \frac{n!}{k!(n-k)!} . \]


::: {.example #akqj}
*You are dealt a "hand" of 13 cards from a deck of 52 cards. What is the probability that you have the Ace, King, Queen, and Jack of Spades?*

Here, $\Omega$ is the set of all 13-card hands from the deck, and $A$ is the subset of those that contain the AKQJ of Spades.

Using the binomial coefficient notation, it's clear that
\[ |\Omega| = \binom{52}{13} = \frac{52\times51\times\cdots\times41\times40}{13\times12\times\cdots\times2\times1} . \]

What about $|A|$? If we fix the fact that the hand contains the 4 cards AKQJ of Spades, then it also contains $13-4=9$ cards out of the other $52-4 = 48$ remaining cards in the deck. This makes
\[ |A| = \binom{48}{9} = \frac{48\times47\times\cdots\times41\times40}{9\times8\times\cdots\times2\times1}\]
hands.

Thus the probability that the hand contains AKQJ of Spades is
\[ \mathbb P(A) = \frac{|A|}{|\Omega|} = \frac{\binom{48}{9}}{\binom{52}{13}} . \]

Conveniently, we can simplify the expression quite a lot, because plenty of cancellation will occur. We have
\begin{align*}
\mathbb P(A) = \frac{\binom{48}{9}}{\binom{52}{13}}
  &= \frac{\frac{48\times47\times\cdots\times41\times40}{9\times8\times\cdots\times2\times1}}{\frac{52\times51\times\cdots\times41\times40}{13\times12\times\cdots\times2\times1}} \\
  &= \frac{48\times47\times\cdots\times41\times40}{52\times51\times\cdots\times41\times40} \times \frac{13\times12\times\cdots\times2\times1}{9\times8\times\cdots\times2\times1} \\
  &= \frac{13\times12\times11\times10}{52\times51\times50\times49} \\
  &\approx 0.0026 ,
\end{align*}
or about 1 in every 380 hands.
:::


## Birthday problem  {#birthday}

::: {.example}
*There are $k = 23$ students in a class. What is the probability that at least two of the students share a birthday?*

This a famous problem, known as the "birthday problem". You may have seen this problem before -- but let's try to solve it using the techniques from this section of notes. If you haven't seen it before, you might like to guess what you think the answer might be. (We'll assume all days are equally likely for birthdays, and ignore the leap day 29 February.)

The sample space $\Omega$ is the set of possible birthdays for all $k$ students. Clearly $|\Omega| = 365^k$.

Let $A$ be the even that at least one pair of student share a birthday. Since this is an "at least" event, it seems like it might be a good idea to look instead at the complementary event $A^\comp$. If $A$ is the event that there's at least one shared birthday, then $A^\comp$ is the event that there are *no* shared birthdays; that is, $A^\comp$ is the event that all $k$ students have *different* birthdays.

So what is $|A^\comp|$, the number of ways the $k$ students can have different birthdays? Well, the first student can have any of the 365 days for their birthday. For them to have different birthdays, the second student only has 364 days available. Then the third student must avoid the birthday of students 1 and 2, so has 363 available days, and so on. We see that 
\[ |A^\comp| = 365 \times 364 \times \cdots \times (365 - k + 1) = 365^{\underline{k}} . \]

Hence, the probability at least two students share a birthday is
\[ \mathbb P(A) = 1 - \mathbb P(A^\comp) = 1 - \frac{365^{\underline{k}}}{365^k} = 1 - \frac{365}{365} \cdot \frac{364}{365} \cdots \frac{365-k+1}{365} . \]

Setting $k = 23$, we can calculate the required answer in R:
```{r}
k <- 23
1 - prod((365:(365 - k + 1)) / 365)
```
The probability is 50.7%. So it's more likely than not that at least two students share a birthday.
:::

Some people find it surprising that only 23 students have such a high probability of sharing a birthday, since 23 is so small compared to 365. But remember there are $\binom{23}{2} = 253$ *pairs* of birthdays, and each of those 253 pairs is a potential match.



## Summary  {#summary-L06 .unnumbered}

::: {.mysummary}
* Ordering $n$ objects can be done in $n! = n^{\underline{n}} = n(n-1)\cdots2\cdot1$ ways.
* The number of ways to sample $k$ objects out of $n$ when the order doesn't matter is given by the binomial coefficient $\binom nk = \ff{n}{k}/k!$.
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Sections 3.2 and 3.3.

On [Problem Sheet 2](#P2), you should now be able to complete all questions.

<!--
There's one other useful fact about the binomial coefficient we should mention.

::: {.theorem}
\[ \binom nk = \binom{n}{n-k}. \]
:::

We'll give two different proofs of this fact.

::: {.proof}
We can use the formula for the binomial coefficient in terms of the factorial function. This formula gives
\[ \binom nk = \frac{n!}{k!(n-k)!} \qquad \binom{n}{n-k} = \frac{n!}{(n-k)!k!} . \]
It's clear from the factorial expression that these two quantities are equal.
:::

::: {.proof}
Suppose we have $n$ balls, and we want to paint $k$ of the red and the other $n-k$ blue. How many ways can we do this?

One way is to say there are $\binom nk$ ways to choose the $k$ balls to paint red, then we are forced paint the other $n - k$ blue.

Another way is to say there are $\binom{n}{n-k}$ to choose the $n-k$ balls to paint blue, then we are forced to paint the other $k$ red.

We have "double counted" the same quantity two different ways, so the answer must be the same, so
\[ \binom nk = \binom{n}{n-k}. \]
:::

Which proof do you prefer? (I strongly prefer the second proof, because I think it doesn't just *verify* that the theorem is true, but further explains *why* the result is true.)
-->

<!--chapter:end:sections/L06-classical-ii.Rmd-->

# Problem Sheet 2  {#P2 .unnumbered}



<style>
.myanswers { 
display: none !important;
}
</style>



\commfalse

<!--
::: {.mysummary}
You can [download this problem sheet as a PDF file](P2-sheet.pdf)
:::
-->

::: {.mysummary}
This is Problem Sheet 2. This problem sheet covers material from Lectures 3 to 6. You should work through all the questions on this problem sheet in preparation for your tutorial in Week 4. The problem sheet contains two assessed questions, which are due in by **2pm on Monday 30 October**.
:::

## A: Short questions {#P2-short .unnumbered}

```{r, child = "problems/questions/P2-short.Rmd"}
```

## B: Long questions {#P2-long .unnumbered}

```{r, child = "problems/questions/P2-long.Rmd"}
```


## C: Assessed questions {#P2-assessed .unnumbered}

::: {.mysummary}
The last two questions are **assessed questions**. These two questions count for 3% of your final mark for this module.

The deadline for submitting your solutions is **2pm on Monday 30 October** at the beginning of Week 5. You should submit a PDF to Gradescope.
Your work will be marked by your tutor and returned on Monday 6 November, when solutions will also be made available.

Both questions are "long questions", where the marks are not only for mathematical accuracy but also for the clarity and completeness of your explanatory writing. 

You should not collaborate with others on the assessed questions: your answers must represent solely your own work. The University's rules on [academic integrity](https://library.leeds.ac.uk/info/1401/academic_skills/46/academic_integrity_and_plagiarism) -- and the related punishments for violating them -- apply to your work on the assessed questions.
:::

```{r, child = "problems/questions/P2-assessed.Rmd"}
```

## Solutions to short questions {#P2-short-sols .unnumbered}

**A1.** (a) (i) $\{0,1,\dots, 4\}$ (ii) $\{ \text{HHHH}, \text{HHHT}, \text{HHTH},\dots, \text{TTTT} \}$ (b) (i) 5 (ii) 16.  
**A2.** (a) $C \cap A^\comp$ (b) $A \cup B \cup C$ (c) $(B \cup C) \cap (B \cap C)^\comp$ or $(B \cap C^\comp) \cup (B^\comp \cap C)$  
(d) $(A \cap B \cap C^\comp) \cup (A \cap B^\comp \cap C) \cup (A^\comp \cap B \cap C)$ or other equivalent  
**A3.** (a) 720 (b) 4092 (c) 1680 (d) 210  
**A4.** (a) $\frac{4}{25} = 0.16$ (b) $\frac{2}{15} = 0.133$


<!--chapter:end:problems/P2.Rmd-->

# Independence and conditional probability  {#L07-conditional}



## Independent events  {#independent-events}


*Suppose 40% of people have blond hair, and 20% of people have blue eyes. What proportion of people have both blond hair and blue eyes?*

The answer to this question is: we don't know. The question doesn't give us enough information to tell. However, *if* it were the case that having blond hair didn't effect your chance of having blue eyes, *then* we could work out the answer. If that were true, we would think that the 20% of people with blue eyes would equally make up both 20% of the blonds and also 20% of the non-blonds. Thus the proportion of people with blond hair and blue eyes would be this 20% of the 40% of people with blond hair; and 20% of 40% is $0.2 \times 0.4 = 0.08$, or 8%.

To put it in probability language, *if* blond hair and blue eyes were unrelated, then we would expect that
  \[ \mathbb P(\text{blond hair and blue eyes}) = \mathbb P(\text{blond hair}) \times \mathbb P(\text{blue eyes}) . \]
This is an important property known as "independence".

::: {.definition}
Two events $A$ and $B$ are said to be **independent** if
\[ \mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B) .  \]
:::

There are two ways we can use this definition.

* If we know $\mathbb P(A)$, $\mathbb P(B)$, and $\mathbb P(A \cap B)$, then we can find out whether or not $A$ and $B$ are independent by checking whether or not $\mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B)$.
* If we know $\mathbb P(A)$ and $\mathbb P(B)$ and we know that $A$ and $B$ are independent, then we can find $\mathbb P(A \cap B)$ by calculating $\mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B)$.

In this second case, we might know $A$ and $B$ are independent because we are specifically told they are in a question. But alternatively we might reason that $A$ and $B$ must be independent because the related experiments are not physically related. For example if we roll a dice then toss a coin, we might reason that $\{\text{roll a 5}\}$ and $\{\text{the coin lands Heads}\}$ must be independent because the dice roll doesn't effect the coin toss -- we could then use the independence assumption in calculations.

::: {.example}
*I roll a single dice. Let $A = \{\text{even number}\} = \{2,4,6\}$ be the event I roll an even number, and let $B = \{\text{at least 4}\} = \{4,5,6\}$ be the event I roll at least 4. Are the events $A$ and $B$ independent?*

Clearly we have $\mathbb P(A) = \frac36 = \frac12$ and $\mathbb P(B) = \frac 36 = \frac12$. The intersection is $A \cap B = \{4,6\}$, so $\mathbb P(A \cap B) = \frac26 = \frac13$. So we see that
\[ \mathbb P(A\cap B) = \frac13  \qquad \text{and} \qquad  \mathbb P(A)\, \mathbb P(B) = \frac12 \times \frac12 = \frac14 . \]
So $\mathbb P(A \cap B) \neq \mathbb P(A)\, \mathbb P(B)$, and the two events are not independent.
:::

::: {.example}
*A biased coin has probability $p$ of landing Heads and probability $1-p$ of landing Tails. You toss the coin 3 times. Assuming tosses of the coin are independent, calculate the probability of getting exactly 2 Heads.*

There are three ways we could get exactly 2 Heads: HHT, HTH, or THH. For the first of these,
\[ \mathbb P(\text{HHT}) = \mathbb P(\text{first coin H} \cap \text{second coin H} \cap \text{third coin T}) . \]
Since tosses of the coin are independent, we therefore have
\begin{align*}
\mathbb P(\text{HHT})
  &= \mathbb P(\text{first coin H}) \times \mathbb P ( \text{second coin H} )\times \mathbb P(\text{third coin T}) \\
  &=p \times p \times (1-p) \\
  &= p^2(1-p).
\end{align*}

Similarly,
\[ \mathbb P(\text{HTH}) = \mathbb P(\text{THH}) = p^2(1-p) \]
also.

Finally, because the events are disjoint, we have
\[ \mathbb P(\text{HHT} \cup\text{HTH} \cup \text{THH}) = \mathbb P(\text{HHT} ) + \mathbb P(\text{HTH}) + \mathbb P(\text{THH}) = 3p^2(1-p) . \]
:::




## Conditional probability  {#conditional}


Let us to return to the example of blond hair and blue eyes. Suppose the population statistics are like this:

| | **Brown hair** | **Blond hair** | **Total** |
|:--------------:|:---:|:---:|:----:|
| **Brown eyes** | 50% | 30% |  **80%** |
| **Blue eyes**  | 10% | 10% |  **20%** |
| **Total**      | **60%** | **40%** | **100%** |

It turns out that $\mathbb P(\text{blond hair and blue eyes}) = 0.1 \neq 0.08$, so having blond hair and having blue eyes are not in fact independent.

We know from this table that 20% of people have blue eyes. But suppose you already know that someone has blond hair: what *then* is the probability they have blue eyes *given* that they have blond hair?

Well, the 40% of blond-haired people is made up of the 10% of people who also have blue eyes along with their blond hair, and the 30% of people who have brown eyes along with their blond hair. So of the 40% of blond-haired people, only one quarter of that 40% -- which makes 10% -- have blue eyes. If we use a vertical line $|$ in a probability  to mean "given" (or "assuming that" or "conditional upon"), then we can write this as
\[  \mathbb P(\text{blue eyes} \mid \text{blond hair}) = \frac{\mathbb P(\text{blue eyes and blond hair})}{\mathbb P(\text{blond hair})} = \frac{0.1}{0.4} = \frac14. \]

What we've seen here is called a "conditional probability".

::: {.definition}
Let $A$ and $B$ be events, with $\mathbb P(A) > 0$. Then the **conditional probability of $B$ given $A$** is defined to be
\[  \mathbb P(B \mid A) = \frac{\mathbb P(A \cap B)}{\mathbb P(A)} . \]
:::

The condition $\mathbb P(A) > 0$ is just to ensure we don't have any "divide by 0" errors. (I normally won't bother saying this explicitly -- any statement about conditional probability will implicitly assume that the event being conditioned on has nonzero probability.)

Conditional probability ties in with independence in an important way. Suppose $A$ and $B$ are independent, so $\mathbb P(A \cap B) = \mathbb P(A) \, \mathbb P(B)$. Then the conditional probability becomes
\[ \mathbb P(B \mid A) = \frac{\mathbb P(A \cap B)}{\mathbb P(A)} =  \frac{\mathbb P(A) \, \mathbb P(B)}{\mathbb P(A)} = \mathbb P(B) , \]
so $\mathbb P(B \mid A) = \mathbb P(B)$. In other words, if $A$ and $B$ are independent, then $A$ happening doesn't affect the probability of $B$ happening (and vice versa).

So when we have independence, we know that $\mathbb P(A \cap B) = \mathbb P(A)\,\mathbb P(B)$, and the mathematics is quite easy. But conditional probability tells us how things work when we don't have independence.

As with independence, we can use the definition of conditional probability in two ways. The first way is that if we know $\mathbb P(A \cap B)$ and $\mathbb P(A)$, then we can calculate the conditional probability of $B$ given $A$ as
\[  \mathbb P(B \mid A) = \frac{\mathbb P(A \cap B)}{\mathbb P(A)} . \]

::: {.example}
*With the dice roll again, what's the probability of rolling at least 4 given that you roll an even number?*

We previously calculated
\begin{gather*}
\mathbb P(\text{even and at least 4}) = \mathbb P(A \cap B) = \tfrac{2}{6} \\
\mathbb P(\text{even number}) = \mathbb P(A) = \tfrac{3}{6} .
\end{gather*}
Hence
\[ \mathbb P(\text{even} \mid \text{at least 4}) = \mathbb P(B \mid A) = \frac{\mathbb P(A \cap B)}{\mathbb P(A)} = \frac{\frac26}{\frac36} = \tfrac23 . \]

This is intuitively correct: of the three possibilities of rolling at least 4, $\{4,5,6\}$, two of those three are even, so the probability is $\frac23$.
:::

Note that with classical probability $\mathbb P(A) = |A|/|\Omega|$, where we have finitely many equally likely outcomes, we have
\[ \mathbb P(B \mid A) = \frac{\mathbb P(A \cap B)}{\mathbb P(A)} = \frac{\frac{|A\cap B|}{|\Omega|}}{\frac{|A|}{|\Omega|}} = \frac{|A \cap B|}{|A|} . \]
This is effectively reducing ourselves from the whole sample space $\Omega$ and moving to a smaller "restricted sample space" $A$.

Note that this worked in the previous example, when
\[ \mathbb P(B \mid A) = \frac{|A \cap B|}{|A|} = \frac{2}{3} . \]


## Chain rule  {#chain-rule}

The second way to use the definition of conditional probability is that if we know $\mathbb P(A)$ and $\mathbb P(B \mid A)$, then we can calculate the event that both $A$ and $B$ occur as
\[ \mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B \mid A). \]
This can be a particularly useful tool when $A$ concerns the first stage of an experiment and $B$ the second stage. This says that the probability $A$ happens then $B$ happens is equal to the probability $A$ happens multiplied the conditional probability, given that $A$ has already happened, that $B$ then happens too.

We can extend this to more events. For three events, we have
\begin{align*}
\mathbb P(A \cap B \cap C)
  &= \mathbb P(A \cap B) \, \mathbb P(C \mid A \cap B) \\
  &= \mathbb P(A) \, \mathbb P(B \mid A)\, \mathbb P(C \mid A \cap B) ,
\end{align*}
which can be useful when we have three stages of an experiment.

Continuing that process, we get a general rule.

::: {.theorem #thchain name="Chain rule"}
For events $A_1, A_2, \dots, A_n$, we have
\begin{multline*}  \mathbb P(A_1 \cap A_2 \cap \cdots \cap A_n) \\
  = \mathbb P(A_1) \, \mathbb P(A_2 \mid A_1) \, \mathbb P(A_3 \mid A_1 \cap A_2) \cdots \mathbb P(A_n \mid A_1 \cap A_2 \cap \cdots \cap  A_{n-1}) .\end{multline*}
:::

At each step, we need to calculate the probability of that step given all the previous steps being successful. We then multiply them all together.

Often questions that can be solved using the classical probability counting methods from Section 3 also be solved "step by step" using the chain rule. (It's a matter of personal taste which you prefer, but I find that chain rule methods are often simpler and more intuitive.)

::: {.example}
*Recall the Lotto problem from Example \@ref(exm:lotto): What is the probability we match 6 balls from 59?*

Let $A_1, A_2, \dots, A_6$ be the events that the first, second, ..., sixth balls out of the machine are on our ticket. Clearly $\mathbb P(A_1) = \frac{6}{59}$, as we have six numbers on our ticket that the first ball could match. The conditional probability that the second ball matches given that the first ball matched is $\mathbb P(A_2 \mid A_1) = \frac{5}{58}$, because there are 58 balls left in the machine and, given that we got the first number right, there are 5 numbers left on our ticket. Similarly, $\mathbb P(A_3 \mid A_1 \cap A_2) = \frac{4}{57}$, and so on, until $\mathbb P(A_6 \mid A_1 \cap \cdots\cap A_5) = \frac{1}{54}$.

So, using the chain rule, we get
\begin{align*}
\mathbb P(A_1 \cap A_2 &\cap \cdots \cap A_6) \\
&= \mathbb P(A_1) \, \mathbb P(A_2 \mid A_1) \, \mathbb P(A_3 \mid A_1 \cap A_2) \cdots \mathbb P(A_6 \mid A_1 \cap \cdots \cap A_5) \\
&= \frac{6}{59} \times \frac{5}{58} \times \frac{4}{57} \times \frac{3}{56} \times \frac{2}{55} \times \frac{1}{54} .
\end{align*}

The answer we got before was
\[ \frac{1}{\binom{59}{6}} = \frac{6 \times 5 \times 4 \times 3 \times 2 \times 1}{59 \times 58 \times 57 \times 56 \times 55 \times 54} = \frac{1}{45 \text{ million}} . \]
It's easy to see that this is the same answer. The structure of the answers shows how our previous classical probability method got the answer "all at once", while this new chain rule method gets the answer "one step at a time".
:::




## Summary  {#summary-L07 .unnumbered}

::: {.mysummary}
* Two events are independent if $\mathbb P(A \cap B) = \mathbb P(A)\, \mathbb P(B)$.
* The conditional probability of $B$ given $A$ is ${\displaystyle \mathbb P(B \mid A) = \frac{\mathbb P(A \cap B)}{\mathbb P(A)}}$.
* The chain rule is
\begin{multline*}
\mathbb P(A_1 \cap A_2 \cap \cdots \cap A_n) \\
  = \mathbb P(A_1) \, \mathbb P(A_2 \mid A_1) \, \mathbb P(A_3 \mid A_1 \cap A_2) \cdots \mathbb P(A_n \mid A_1 \cap \cdots \cap  A_{n-1}) . 
\end{multline*}
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Sections 2.1 and 2.2.
* [Grimmett and Welsh, *Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991002938669705181), Sections 1.6 and 1.7.

<!--chapter:end:sections/L07-conditional.Rmd-->

# Two theorems on conditional probability {#L08-two-theorems}

Last time we met the conditional probability $\mathbb P(B \mid A)$ of one event $B$ given another event $A$. In this lecture we will be looking two very useful theorems about conditional probability, called the **law of total probability** and **Bayes' theorem** -- and they're particularly powerful when used together.

## Law of total probability  {#total-prob}


::: {.example #dice-total}
*My friend has three dice: a 4-sided dice, a 6-sided dice, and a 10-sided dice. He picks one of them at random, with each dice equally likely. What is the probability my friend rolls a 5?*

If my friend were to tell which dice he picked, then this question would be very easy! If we write $D_4$, $D_6$ and $D_{10}$ to be the events that he picks the 4-sided, 6-sided, or 10-sided dice, then we know immediately that
\[ \mathbb P(\text{roll 5} \mid D_4) = 0 \qquad \mathbb P(\text{roll 5} \mid D_6) = \tfrac16 \qquad \mathbb P(\text{roll 5} \mid D_{10}) = \tfrac{1}{10} .  \]
What we need is a way to combine the results for different "sub-cases" into an over-all answer.
:::

Luckily, there exists just such a tool for this job! It's called the "law of total probability" (also known as the "partition theorem"). The important point is to make sure that the different sub-cases cover all possibilities, but that only one of them happens at a time.

::: {.definition}
A set of events $A_1, A_2, \dots, A_n$ are said to be a **partition** of the sample space $\Omega$ if 

1. they are disjoint, in that $A_i \cap A_j = \varnothing$ for all $i \neq j$;
1. they cover space, in that $A_1 \cup A_2 \cup \cdots \cup A_n = \Omega$.
:::

::: {.theorem #thlawtotal name="Law of total probability"}
Let $A_1, A_2, \dots, A_n$ be a partition, and $B$ another event. Then
\[ \mathbb P(B) = \sum_{i=1}^n \mathbb P(A_i) \, \mathbb P(B \mid A_i) . \]
:::

So the law of total probability tells us we can add up the probabilities $\mathbb P(B \mid A_i)$ for each of the sub-cases provided we weight them by how likely $\mathbb P(A_i)$ by how likely each sub-case is.

::: {.proof}
Since the partition of $A_i$s cover space, we can split up $B$ depending on which part of the partition it is in:
\[  B = (B \cap A_1) \cup (B \cap A_2) \cup \cdots \cup (B \cap A_n) .  \]

*[I meant to draw a picture here, but didn't get round to it -- perhaps you'd like to draw your own?]*

Since the $A_i$ are disjoint, the union on the right is disjoint also.
Therefore we can use Axiom 3 to get
\[ \mathbb P(B) = \sum_{i=1}^n \mathbb P(B \cap A_i) . \]
But using the definition of conditional probability, each "summand" (term inside the sum) is
\[ \mathbb P(B \cap A_i) = \mathbb P(A_i) \, \mathbb P(B \mid A_i) . \]
The result follows.
:::

::: {.thpart}
**Example \@ref(exm:dice-total) continued.** Returning to our dice example, we see that $\{D_4, D_6, D_{10}\}$ is indeed a partition, since my friend must choose exactly one of the three dice. So the law of total probability tells us that
\[ \mathbb P(\text{roll 5}) = \mathbb P(D_4) \, \mathbb P(\text{roll 5} \mid D_4) +  \mathbb P(D_6) \, \mathbb P(\text{roll 5} \mid D_6) + \mathbb P(D_{10}) \, \mathbb P(\text{roll 5} \mid D_{10}) . \]

We were told that all the dice were picked with equal probability, so $\mathbb P(D_4) = \mathbb P(D_6) = \mathbb P(D_{10}) = \frac13$, and we've already  calculated the individual conditional probabilities as
\[ \mathbb P(\text{roll 4} \mid D_4) = 0 \qquad \mathbb P(\text{roll 4} \mid D_6) = \tfrac16 \qquad \mathbb P(\text{roll 4} \mid D_{10}) = \tfrac{1}{10} .  \]
Therefore, we have
\[ \mathbb P(\text{roll 5}) = \tfrac13\times 0 +  \tfrac13\times\tfrac16 +  \tfrac13\times\tfrac1{10} = \tfrac{8}{90} = 0.089. \]
:::


## Bayes' theorem  {#bayes}



In this section, we will discuss an important result called **Bayes' theorem**. 
Let's first state and prove this result, and do an example, and then afterwards we'll talk about two reasons why Bayes' theorem is so important.

::: {.theorem #thbayes name="Bayes' theorem"}
For events $A$ and $B$ with $\mathbb P(A), \mathbb P(B) > 0$, we have
\[ \mathbb P(A \mid B) = \frac{\mathbb P(A) \,\mathbb P(B \mid A)}{\mathbb P(B)} .  \]
:::

Bayes' theorem is thought to have first appeared in the writings of Rev. [Thomas Bayes](https://mathshistory.st-andrews.ac.uk/Biographies/Bayes/), a British church minister and mathematician, shortly after his death, in the 1760s. (Bayes' work was significantly edited by [Richard Price](https://mathshistory.st-andrews.ac.uk/Biographies/Price/), another minister--mathematician, and many historians of mathematics think that Price deserves a good share of the credit.)

::: {.proof}
From the definition of conditional probability, we can write $\mathbb P(A \cap B)$ in two different ways: we can write it as
\[  \mathbb P(A \cap B) = \mathbb P(A) \, \mathbb P(B\mid A) , \]
but we can also write it as
\[  \mathbb P(A \cap B) = \mathbb P(B) \, \mathbb P(A\mid B) . \]
Since these are two different ways of writing the same thing, we can equate them, to get
\[ \mathbb P(A) \, \mathbb P(B\mid A) = \mathbb P(B) \, \mathbb P(A\mid B) . \]
Dividing both sides by $\mathbb P(B)$ gives the result.
:::

::: {.example}
*My friend again secretly picks the 4-sided, 6-sided, or 10-sided dice, each with probability $\frac13$. He rolls that secret dice, and tells me he rolled a 5. What is the probability he picked the 6-sided dice?*

This is asking us to calculate $\mathbb P(D_6 \mid \text{roll 5})$. Bayes' theorem tells us that
\[
  \mathbb P(D_6 \mid \text{roll 5})
  = \frac{\mathbb P(D_6) \, \mathbb P(\text{roll 5} \mid D_6)}{\mathbb P(\text{roll 5})} 
  = \frac{\frac13 \times \frac16}{\frac{8}{90}} 
  = \tfrac{5}{8} ,
\]
since we had calculated $\mathbb P(\text{roll 5}) = \frac{8}{90}$ in the previous subsection.
:::

The first way to think about Bayes' theorem is that it tells us how to relate $\mathbb P(A \mid B)$ and $\mathbb P(B \mid A)$. Remember that $\mathbb P(A \mid B)$ and $\mathbb P(B \mid A)$ are not the same thing! The conditional probability someone is under 40 given they are a Premiership footballer is very high, but the conditional probability someone is a Premiership footballer given they are under 40 is very low.

Bayes' theorem, in this first view, is a useful technical result that helps us switch the order of a conditional probability from $B$ given $A$ to $A$ given $B$: we have
\[ \mathbb P(A \mid B) = \frac{\mathbb P(A)}{\mathbb P(B)} \times \mathbb P(B \mid A) .  \]

In the dice example, the probability $\mathbb P(\text{roll 5} \mid D_6) = \frac16$ was very obvious, but Bayes' theorem allowed us to reverse the conditioning, to find $\mathbb P(D_6 \mid \text{roll 5}) = \frac58$ instead.

The second way to think about Bayes' theorem is that it tells us how to update our beliefs as we acquire more evidence. That is, we might start by believing that the probability some event $A$ will occur is $\mathbb P(A)$. But then we find out that $B$ has occurred, so we want to incorporate this knowledge and update our belief of the probability $A$ will occur to $\mathbb P(A \mid B)$, the conditional probability $A$ will occur given this new evidence $B$.

Bayes theorem, in this second view, tells us how to update from $\mathbb P(A)$ to $\mathbb P(A \mid B)$: we have
\[ \mathbb P(A \mid B) = \mathbb P(A) \times \frac{\mathbb P(B \mid A)}{\mathbb P(B)} .  \]

In the dice example, we initially believed there was a $\mathbb P(D_6) = \frac13 = 0.333$ chance our friend had chosen the six-sided dice. But when we heard that our friend had rolled a 5, we updated our belief to now thinking there was now a $\mathbb P(D_6 \mid \text{roll 5}) =\frac58 = 0.625$ chance it was the 6-sided dice.

This second way of thinking about Bayes' theorem is at the heart of **Bayesian statistics**. In Bayesian statistics, we start with a "prior" belief about a model, then, after collecting some data, we update, using Bayes' theorem, to a "posterior" belief about the model. We will discuss Bayesian statistics much more in Week 10.




Quite often we use Bayes' theorem and the law of total probability together. If we have a partition $A_1, A_2, \dots, A_n$, perhaps representing some possible hypotheses, and we observe some evidence $B$, then Bayes' theorem tells us how likely each hypothesis is given the evidence:
\[ \mathbb P(A_i \mid B) = \frac{\mathbb P(A_i) \,\mathbb P(B \mid A_i)}{\mathbb P(B)} .  \]
But this shared denominator $\mathbb P(B)$ can be expanded using the law of total probability
\[ \mathbb P(B) = \sum_{j=1}^n \mathbb P(A_j) \,\mathbb P(B \mid A_j) . \]
Putting these together, we get the following.

::: {.theorem #bayes-total}
Let $\{A_1, A_2, \dots, A_n\}$ be a partition of a sample space and let $B$ be another event. Then, for all $i=1,2,\dots,n$, we have
\[ \mathbb P(A_i \mid B) = \frac{\mathbb P(A_i) \,\mathbb P(B \mid A_i)}{\sum_{j=1}^n \mathbb P(A_j) \, \mathbb P(B \mid A_j)} .  \]
:::

This is essentially what we did with the dice example -- although we split up the calculation into two separate parts rather than using this formula directly.


## Diagnostic testing  {#screening}

::: {.example}
*Members of the public are tested for a certain rare disease. About 2% of the population have the disease. The test is 95% accurate, in the following sense: if you have the disease, there's a 95% chance you correctly get a positive test result; while if you don't have the disease, there's a 95% chance you correctly get a negative test result. Suppose you get a positive test result. What is the probability you have the disease?*

The first thing we have to do is translate the words in the question into probability statements. Let $D$ be the event you have the disease, so $D^\comp$ is the event you don't have the disease, and let $+$ be the event you get a positive result. Then the question tells us that

* $\mathbb P(D) = 0.02$ and $\mathbb P(D^\comp) = 0.98$;
* $\mathbb P({+} \mid D) = 0.95$;
* $\mathbb P({+}\mid D^\comp) = 0.05$;
* we want to find $\mathbb P(D \mid {+})$.

Importantly, $D$ (you have the disease) and $D^\comp$ (you don't) make up a partition. So Theorem \@ref(thm:bayes-total) tells us that
\[  \mathbb P(D \mid {+}) = \frac{\mathbb P(D) \,\mathbb P({+} \mid D)}{\mathbb P(D) \,\mathbb P({+} \mid D)+\mathbb P(D^\comp) \,\mathbb P({+} \mid D^\comp)} . \]
Putting in all the numbers we have, we get
\[ \mathbb P(D \mid {+}) = \frac{0.02 \times 0.95}{0.02 \times 0.95 + 0.98 \times 0.05} = 0.28 .\]

So if you get a positive result on this 95%-accurate test, there's still only about a 1 in 4 chance you actually have the disease.
:::

Many people find this result surprising. It sometimes helps to put more concrete numbers on things. Suppose 1000 people get tested. On average, we expect about 20 of them to have the disease, and 980 of to not have the disease. Of the 20 with the disease, on average 19 will correctly test positive, while 1 will test negative. Of the 980 without the disease, an average 931 will correctly test negative, but 49 will wrongly test positive. So of the $19+49 = 68$ people with positive tests, only 19 of them actually have the disease, which is 28%.

The key point is that the disease is rare -- only 2% of people have it. So even though positive test increases the likelihood you have the disease a lot (it's about 14 times more likely), it's not enough to make it a very large probability.



## Summary  {#summary-L08 .unnumbered}

::: {.mysummary}
* The law of total probability says that if $A_1, A_2, \dots A_n$ is a partition of the sample space (that is, exactly one of them occurs), then
\[ \mathbb P(B) = \sum_{i=1}^n \mathbb P(A_i) \, \mathbb P(B \mid A_i) . \]
* Bayes' theorem says that ${\displaystyle \mathbb P(A \mid B) = \frac{\mathbb P(A) \,\mathbb P(B \mid A)}{\mathbb P(B)} }$.
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Sections 2.1 and 2.2.
* [Grimmett and Welsh, *Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991002938669705181), Section 1.8.

On [Problem Sheet 3](#P3), you should now be able to complete Questions A1, A2, B1--3 and C1.

<!--chapter:end:sections/L08-two-theorems.Rmd-->

# Discrete random variables  {#L09-discrete-rv}

<!--

## What is a random variable?  {#rv}

Let's consider again the case of rolling two dice. We know that the sample space is the set of pairs of numbers between 1 and 6.
But if we are rolling the two dice as part of a board game, we might only care about the *total* score on the two dice, and the actual the two individual dice scores might be irrelevant. Let us wrote write $X$ for the total score. This $X$ is a sort of "numerical summary" of the experiment. Probabilists call such a numerical summary a **random variable**.

One we've defined this random variable $X$, it can be easier to work with $X$ than with sample spaces and events. For example, if we want to know the probability that our two dice rolls add up to 5, it's more convenient to write
\[ \mathbb P(X = 5) \]
rather than
\[ \mathbb P(A) \quad \text{where} \quad A = \big\{ (1,4), (2,3), (3,2), (4,1) \big\} . \]
The probability that $X = 5$ is $\mathbb P(X = 5) = \frac{4}{36} = \frac{1}{9}$. We might also be interested in other things about the total score $X$, like what the average total score over many pairs if dice rolls is.

The good news is that, once we have properly set up our random variable $X$, we can often then choose to ignore things like the sample space, the probability measure, and individual events.

Random variables are typically given capital letters from late in the alphabet, like $X$, $Y$, $Z$. Values that those random variables take are often given the lower-case equivalent, like $x$, $y$, $z$.

This idea of a random variable as a numerical summary of an experiment is how we *think* about random variables when solving problems. On the other hand, as mathematicians, we also want to define carefully what a random variable is as a mathematical object. We'll discuss that now (but if you find the next couple of paragraphs difficult to follow, you won't miss much if you skip them).

In this formal mathematical view, our experiment of rolling two dice is represented by a sample space
  \[  \Omega = \big\{ \boldsymbol\omega = (\omega_1, \omega_2) : \omega_1, \omega_2 \in \{1,2,3,4,5,6\} \big\}  \]
of pairs $\boldsymbol\omega = (\omega_1, \omega_2)$ of numbers from 1 to 6, where $\omega_1$ represents the first dice roll and $\omega_2$ the second dice roll.
The random variable $X$ is the score on the first dice plus the score on the second dice -- that is,
\[ X(\boldsymbol\omega) = \omega_1 + \omega_2 . \]
In other words, $X$ is a *function* which takes in a sample outcome $\boldsymbol\omega \in \Omega$ and outputs a real number $X = X(\boldsymbol\omega) = \omega_1 + \omega_2$.



::: {.definition}
Let $\Omega$ be a sample space. Then a **random variable** is a function $X$ from $\Omega$ to the real numbers $\mathbb R$; that is, to each sample outcome $\omega$ it assigns a real number $X(\omega)$.

Expressions like $\mathbb P(X = x)$ or $\mathbb P(X \in A)$ should be understood as representing more formal probabilities
\[ \mathbb P \big( \{\omega : X(\omega) = x \}\big) \quad \text{or} \quad \mathbb P \big( \{\omega : X(\omega) \in A \}\big)  . \]
:::

It's useful to have a notation for the values a random variable can take.

\newcommand{\Range}{\operatorname{Range}}

::: {.definition}
The set of values a random variable $X$ can take is called its **range**, $\Range(X) = \{X(\omega) : \omega \in \Omega \}$.
:::

So, for example, the range of the dice total $X$ is $\Range(X) = \{2, 3, \dots, 12\}$, because those are the possible outcome from the sum of two dice rolls.

Random variables that we will consider in this module will be one of two types:

* **Discrete random variables** have a range that is a collection of discrete separate counts, so $\Range(X)$ is finite (like the dice total being an integer between 2 and 12) or countably infinite (like the positive integers). Discrete random variables can be used as models for "count data".
* **Continuous random variables** have a range that is a continuum of slowly varying measurements, so $\Range(X)$ is uncountably infinite (like the real numbers, the positive real numbers, or the interval $[0,1]$). Continuous random variables can be used as models for "measurement data".

For this week and the two weeks after, we will look at discrete random variables; later in Lectures 15 to 17 we will look at continuous random variables.


## Probability mass function  {#pmf}


We now consider only discrete random variables $X$, where the range $\Range(X)$ is finite or countably infinite. To fully understand a discrete random variable $X$, we need only understand the probabilities $p(x) = \mathbb P(X = x)$. These are captured by the probability mass function.

::: {.definition}
For a discrete random variable $X$, its **probability mass function** (or **PMF**) is the function $p_X$ where 
\[ p_X(x) = \mathbb P(X = x)  \qquad \text{for $x \in \Range(X)$.} \]
(When the random variable $X$ is obvious from context, we'll just write $p(x)$ without the subscript.)
:::

Once we have the PMF, then Axiom 3 tells us that for any set $A$, we have
\[ \mathbb P(X \in A) = \sum_{x \in A} \mathbb P(X = x) = \sum_{x \in A} p(x) . \]
(Recall that the symbol $\in$ means "is an element of", or just "is in" for short.) So the probability that $X$ is in some set $A$ can be found by simply adding up $p(x)$ for all the values $x$ in $A$. Thus the PMF $p(x)$ is the only thing we need to know.


::: {.example}
Consider tossing a biased coin, that is Heads with probability $p$ and Tails with probability $1-p$. Let $X = 1$ if the coin lands Heads, and $X = 0$ if the coin lands Tails. The PMF $p_X$ of this random variable is given by
\[ p_X(0) = 1 - p \qquad p_X(1) = p . \]

We could alternatively think of the same random variable $X$ as representing the result of an experiment, where $X = 1$ represents a success, with probability $p_X(1) = p$, and $X = 0$ represents a failure, with probability $p_X(0) = 1 - p$.

A random variable $X$ with this PMF is called a **Bernoulli trial** (or a "Bernoulli random variable", or is said to "follow the Bernoulli distribution" -- after the seventeenth-century Swiss mathematician [Jacob Bernoulli](https://mathshistory.st-andrews.ac.uk/Biographies/Bernoulli_Jacob/)). We use the notation $X \sim \text{Bern}(p)$ for short.
:::

::: {.example}
Let $X$ being the sum of two dice rolls. As this is a classical probability problem, the probability $p(x)$ of rolling a total of $x$ is $n(x) / 36$, where $n(x)$ is the number of ways of rolling a total of $x$. So, for example, there is only one way $(1,1)$ of rolling a total of 2, so $p(2) = \frac1{36}$, but there are 5 ways of rolling a 6: $(1,5), (2,4), (3, 3), (4, 2), (5, 1)$; so $p(5) = \frac5{36}$.

The PMF $p$ of $X$ is given by

| $x$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| $p(x)$ | $\frac{1}{36}$ | $\frac{2}{36}$ | $\frac{3}{36}$ | $\frac{4}{36}$ | $\frac{5}{36}$ | $\frac{6}{36}$ |

| $x$ | $\cdots$ | $8$ | $9$ | $10$ | $11$ | $12$ |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| $p(x)$ | $\cdots$ | $\frac{5}{36}$ | $\frac{4}{36}$ | $\frac{3}{36}$ | $\frac{2}{36}$ | $\frac{1}{36}$ |

```{r dice-pmf, cache = TRUE, echo = FALSE}
x <- 2:12
prob <- c(1:6, 5:1)/36

plot(x, prob, type = "h", xlab = "dice total, x", ylab = "probability mass function, p(x)", xlim = c(0, 15), ylim = c(0,0.2), col = "blue", lwd=3)
```
:::



Note that since $p(x) = \mathbb P(X = x)$ is a probability, it must be greater than or equal to 0, by Axiom 1. Further, if we add up $p(x)$ we get
\[ \sum_{x} p(x) =  \sum_{x \in \Range(X)} \mathbb P(X = x) = \mathbb P\big(X \in \Range(X)\big)  =  \mathbb P(\Omega) = 1,  \]
by Axiom 2.
Hence we have the following:

::: {.theorem}
Let $X$ be a discrete random variable, and let $p_X$ be its PMF. Then

* $p_X(x) \geq 0$ for all $x \in \Range(X)$;
* ${\displaystyle \sum_{x \in \Range(X)} p_X(x) = 1}$.
:::

## Cumulative distribution function {#cdf}

Sometimes it is useful to know the probability a random variable $X$ is less or equal to than some value $x$. This is captured by the **cumulative distribution function** (or **CDF**) $F_X$, where
\[ F_X(x) = \mathbb P(X \leq x) = \sum_{y \leq x} p_X(y) \qquad \text{for $x \in \mathbb R$.}  \]

::: {.example}
Let $X \sim \text{Bern}(p)$ be a Bernoulli random variable with success probability $p$. It's impossible for the outcome to be less than 0; it is at least 0 but strictly less than 1 only if it equals 0, which happens with probability $p(0) = 1-p$; and it is certain to at most 1. So its CDF $F$ is
\[ F(x) = \begin{cases} 0 & \text{for $x < 0$} \\
                      1-p & \text{for $0 \leq x < 1$} \\
                      1   & \text{for $x \geq 1$} . \end{cases} \]
:::

::: {.example}
If $X$ is the sum of two dice rolls, then the CDF $F$ is given by adding up the PMF. So, for example:

* If $x < 2$, then $F(x) = 0$, because it's not possible to have $X \leq x < 2$. 
* If $2 \leq x < 3$, then $F(x) = p(2) = \frac{1}{36}$, because $X = 2$ is the only outcome with $X \leq x < 3$.
* If $3 \leq x < 4$, then $F(x) = p(2) + p(3) = \frac{1}{36} + \frac{2}{35} = \frac{3}{36}$, as $X = 2$ or $3$ are the only outcomes with $X \leq x$.
* ...
* If $x \geq 12$, then $F(x) = 1$, because we always have $X \leq 12 \leq x$.

| $x \in {}$ | $(-\infty, 2)$ | $[2,3)$ | $[3,4)$ | $[4,5)$ | $\cdots$ | $[11,12)$ | $[12, \infty)$ |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| $F(x)$ | $0$ | $\frac{1}{36}$ | $\frac{3}{36}$ | $\frac{5}{36}$ | $\cdots$ | $\frac{35}{36}$ | $1$ |

```{r dice-cdf, cache = TRUE, echo = FALSE}
x <- 2:12
prob <- c(1:6, 5:1)/36
cdf <- cumsum(prob)

plot(c(-1,x, 16), c(0, cdf, 1), type = "n", xlab = "x", ylab = "cumulative distribution function, F(x)", xlim = c(0, 15), ylim = c(0,1), col = "blue", lwd = 2)
abline(h = 1, col = "grey", lty = 2)
points(c(-1,x, 16), c(0, cdf, 1), type = "s", col = "blue", lwd = 2)
```

Note that the CDF is a "step function" that starts at 0, then jumps up suddenly at each of the values $2, 3, \dots, 12$, finally ending up at 1.
:::

For any random variable $X$ with CDF $F$,

* if $x$ is smaller than everything in the $\Range(X)$, then $F(x) = 0$, because $X$ cannot be that small;
* if $x$ is greater than everything in the $\Range(X)$, then $F(x) = 1$, because $X$ cannot be any bigger than that;
* $F(x)$ is increasing in $x$, because the probability you are less than $x$ gets bigger as $x$ gets bigger.

-->



## Summary  {#summary-L09 .unnumbered}

::: {.mysummary}
* A random variable is a numerical summary of a random experiment.
* The probability mass function (PMF) is $p_X(x) = \mathbb P(X = x)$.
* The cumulative distribution function (CDF) is $F_X(x) = \mathbb P(X  \leq x)$.
* A Bernoulli random variable is 0 with probability $1-p$ and 1 with probability $p$.
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Sections 4.1 and 4.2.
* [Grimmett and Welsh, *Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991002938669705181), Section 2.1.


<!--
Here, $X$ is an example of what we call a **random variable**. A random variable can be thought of as a numerical summary of an experiment (like the total summarising the two individual dice rolls). But by considering the random variable directly, it often means we don't have to worry so much about exactly what the sample space is, or what probability measure is being used, or which sample outcomes are in a particular event. This often makes our life easier when thinking about probability problems.



The formal definition of a random variable is as a function that turns the outcome into this numerical summary.
-->

<!--
This formal definition of a random variable as a function was summarised by my own first-year probability lecturer as "There's only two things you need to know about the definition of a random variable: first, it's not random; second, it's not a variable."

However, the way we actually *think* about random variables *is* as random and is as variables. In this more informal way of thinking, a random variable is a variable that can take different values with different probabilities -- just as the total of the two dice can be 2 with probability $\frac{1}{36}$, or the value 3 with probability $\frac{2}{36}$, and so on.
-->

<!--chapter:end:sections/L09-discrete-rv.Rmd-->

# Expectation and variance  {#L10-expectation}


<!--

We continue our study of discrete random variables. Recall that the PMF $p_X$ of a discrete random variable $X$ is $p_X(x) = \mathbb P(X = x)$.

## Expectation  {#expectation}


Often, we will be interested in the "average" value of a random variable -- for example, the "average" total from two dice rolls -- which represents what the "central" value of the random variable is. This average is called the "expectation".

::: {.definition}
Let $\Omega$ be a finite or countably infinite sample space, $\mathbb P$ be a probability measure on $\Omega$, and $X$ be a discrete random variable on $\Omega$. Then the **expectation** (or **expected value**) of $X$ is
\[ \mathbb EX = \sum_{\omega \in \Omega} X(\omega) \, \mathbb P(\{\omega\}) . \]

If $p_X$ is the PMF of $X$, then a more convenient formula is
\[ \mathbb EX = \sum_{x \in \Range(X)} x\,p_X(x) . \]
:::

We get the second formula from the first by grouping together all outcomes $\omega$ that lead to the same value $x = X(\omega)$ of $X$. It's only this second formula we actually use when calculating expectations.

Note that "expectation" is simply the name that mathematicians give to the value $\mathbb EX = \sum_x x\, p(x)$. We don't necessarily "expect" to get the value $\mathbb EX$ as the outcome in the normal English-language sense of the word "expect". (Indeed, you might like to check that the expectation of a single dice roll is 3.5, but you certainly don't "expect" to get the number 3.5 in a single roll of the dice!) We will see later in the module that the the expectation can be interpreted as a sort of "long-run mean outcome".

::: {.example}
*Let $X \sim \text{Bern}(p)$ be a Bernoulli trial with success probability $p$. What is the expectation $\mathbb EX$?*

We know that the PMF is $p(0) = 1- p$ and $p(1) = p$. So, using the second formula in the definition, we have
\[ \mathbb EX = \sum_{x} x\,p(x) = 0\times (1-p) + 1\times p = p. \]
:::

::: {.example}
*What is the expected value of the sum of two dice rolls?*

When $X$ is the total of two dice rolls, we found the PMF of $X$ last time. The expectation is
\begin{align*}
  \mathbb EX &= \sum_{x \in \Range(X)} x\,p(x)  \\
    &= 2 \times \tfrac{1}{36} + 3 \times \tfrac{2}{36} + \cdots + 12 \times \tfrac{1}{36} \\
    &= \tfrac{252}{36} \\
    &= 7 .
\end{align*}
:::


## Functions of random variables  {#functions}

In previous examples, we looked at $X$ being the total of the dice rolls. But we could equally well chosen to have looked at a different random variable that is a function of that total $X$, like "double the total and add 1" $Y = 2X + 1$, or "the total minus 4, all squared" $Z = (X-4)^2$. (I'm not sure *why* you'd care about these, but you could study them if you wanted to...)



It is possible, although sometimes a bit tricky, to work out the whole PMF of these new random variables that are functions of $X$ -- and indeed you may learn how to do this if you take more probability or statistics modules next year. Here, we will stick to the easier problem of just calculating the expectation of the new random variables.




::: {.theorem #unconscious name="Law of the unconscious statistician"}
Let $X$ be a random variable, and let $Y = g(X)$ be another random variable that is a function $g$  of $X$. Then
\[  \mathbb EY = \mathbb E\,g(X) = \sum_{x} g(x) \, p_X(x) . \]
:::

(The rather cruel name of this theorem is, I think, because this is the formula you might carelessly write down for $\mathbb Eg(X)$ if you weren't thinking carefully -- but it turns out it's correct!)

::: {.proof}
*(Non-examinable)* 
The PMF of $y$ can be given in terms of the PMF of $x$ -- we just need to add up all the $x$s that lead to the same $y$. That is,
\[ p_Y(y) = \sum_{x\, :\, g(x) = y} p_X(x) . \]
(Remember that the colon $:$ here means "such that", so this is a sum over all the $x$ such that $g(x) = y$.)

Using this, and from the definition of expectation, we have
\begin{align*}
  \mathbb EY &= \sum_y y \, p_Y(y) \\
    &= \sum_y y \sum_{x : g(x) = y} p_X(x) \\
    &= \sum_y \sum_{x : g(x) = y} y\,p_X(x) \\
    &= \sum_y \sum_{x : g(x) = y} g(x) \, p_X(x) ,
\end{align*}
since $y = g(x)$ inside the second sum. But these two sums together are summing over all $x$, just partitioned by which value of $y$ they lead to, so they can be replaced by just a single sum over $x$. That gives the theorem.
:::

There are some functions for which this expression becomes particularly simple.

::: {.theorem #linearity1 name="Linearity of expectation, 1"}
Let $X$ be a random variable. Then

1. $\mathbb E(aX) = a\mathbb EX$;
2. $\mathbb E(X + b) = \mathbb EX + b$.
:::

::: {.proof}
We use the law of the unconscious statistician.

For part 1, we can take the $a$ outside the sum, to get
\[ \mathbb E(aX) = \sum_x ax\, p_X(x) = a\sum_x x\, p_X(x) = a\mathbb EX . \]

For part 2, we have
\begin{align*}
  \mathbb E(X+b) &= \sum_x (x + b)\, p_X(x) \\
    &= \sum_x \big( x\, p_X(x) + b\,p_X(x) \big) \\
    &= \sum_x x\, p_X(x) + \sum_x b\,p_X(x) \\
    &= \mathbb E(X) + b \sum_x p_X(x) \\
    &= \mathbb E(X) + b .
\end{align*}
The last line was because PMFs always add up to 1, so $\sum_x p_X(x) = 1$.
:::

So for our "double the dice total and add 1" random variable $Y = 2X + 1$, we have
\[ \mathbb EY = \mathbb E(2X+1) = 2\mathbb EX + 1 = 2\times 7 + 1 = 15. \]


## Variance  {#variance}

In the same way as the expectation of a random variable tells us about central values of it, the "variance" of a random variable tells us about the spread of typical values.

::: {.definition}
Let $X$ be a random variable with expectation $\mathbb EX = \mu$. Then the **variance** of $X$ is
\[ \Var(X) = \mathbb E(X - \mu)^2 . \]
:::

(To be clear, the notation here means the expectation of $(X-\mu)^2$; and *not* $\mathbb E(X - \mu)$ then squared, which would be $0^2 = 0$.)

Note that $(X - \mu)^2 \geq 0$ is a square, so always non-negative, and hence the variance $\Var(X) \geq 0$ is always non-negative also. Sometimes we call the square-root of the variance the **standard deviation**.

It may not surprise you, if you remember [Lecture 1](#L01-stats) that to go along with this "definitional formula" for the variance, we also have a "computational formula", which can sometimes be more convenient.

::: {.theorem}
Let $X$ be a random variable with expectation $\mathbb EX = \mu$. Then the variance $\Var(X) = \mathbb E(X - \mu)^2$ can also be calculated as
\[ \Var(X) = \mathbb EX^2 - \mu^2 . \]
:::

(Again, $\mathbb EX^2$ means the expectation of $X^2$.)

::: {.proof}
As previously we expand out the brackets, and use linearity of expectation (in the same way we "brought the sum inside" with the sample variance previously). We get
\begin{align*}
  \Var(X) &= \mathbb E(X - \mu)^2 \\
    &= \mathbb E(X^2 - 2\mu X + \mu^2) \\
    &= \mathbb EX^2 - \mathbb E(2\mu X) + \mathbb E \mu^2 \\
    &= \mathbb EX^2 - 2\mu \,\mathbb EX + \mu^2 .
\end{align*}
But we said that $\mathbb EX$ would be called $\mu$, so we can substitute in $\mathbb EX = \mu$, to get
\[ \Var(X) = \mathbb E X^2 - 2\mu^2 + \mu^2 = \mathbb E X^2 - \mu^2 , \]
as required.
:::

(A brief optional note for pedants: Writing $\mathbb E(X^2 - 2\mu X) = \mathbb EX^2 - \mathbb 2\mu X$ is not, strictly speaking, justified by the result that above we called "linearity of expectation, 1". However, you can check that it easily follows from the law of the unconscious statistician, and we will also later see a result we call "linearity of expectation, 2", of which it is a special case.)

::: {.example}
Let $X \sim \text{Bern}(p)$ be a Bernoulli trial, and recall that $\mathbb EX = p$.

Using the definitional formula, we have
\begin{align*}
\Var(X) &= \mathbb E(X-p)^2 \\
        &= (0 - p)^2 \,p_X(0) + (1-p)^2\, p_X(1) \\
        &= p^2\times(1-p) + (1-p)^2 \times p \\
        &= p(1-p)\big(p + (1-p)\big) \\
        &= p(1-p) .
\end{align*}

Alternatively, using the computational formula, we have
\begin{align*}
\Var(X) &= \mathbb EX^2 - p^2 \\
        &= \big(0^2\,p_X(0) + 1^2 p_X(1)\big) - p^2 \\
        &= 0\times(1-p) + 1\times p - p^2 \\
        &= p - p^2 \\
        &= p(1-p) .
\end{align*}
:::

::: {.example}
For the total of two dice, using the computational formula, we have
\begin{align*}
\Var(X) &= \mathbb EX^2 - \mu^2 \\
        &= \left(2^2 \times \frac{1}{36} + 3^2 \times \frac{2}{36} + \cdots + 12^2 \times \frac{1}{36}\right) - 7^2 \\
        &= \frac{1974}{36} - 49 \\
        &= \frac{70}{12} \approx 5.8 .
\end{align*}
:::

Finally, a result on what happens to the variance of simple functions of random variables.

::: {.theorem}
Let $X$ be a random variable. Then

1. $\Var(aX) = a^2\Var (X)$;
2. $\Var(X + b) = \Var(X)$.
:::

You will prove this on [the problem sheet](#P3).

-->

## Summary  {#summary-L10 .unnumbered}

::: {.mysummary}
* The expectation of a random variable $X$ is $\mathbb EX = \sum_x x\, p_X(x)$.
* The variance of a random variable $X$ with expectation $\mu$ is $\Var(X) = \mathbb E(X - \mu)^2$.
* $\mathbb E(aX+b) = a\mathbb EX + b$ and $\Var(aX+b) = a^2\Var(X)$.
:::

**Recommended reading:**

* [Stirzaker, *Elementary Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991013131349705181), Section 4.3.
* [Grimmett and Welsh, *Probability*](https://leeds.primo.exlibrisgroup.com/permalink/44LEE_INST/13rlbcs/alma991002938669705181), Sections 2.3 and 2.4.

On [Problem Sheet 3](#P3), you should now be able to complete all questions.


<!--
::: {.example}
Let $Y = 2X + 1$. Then for each potential outcome $x$ of $X$, there is a matching outcome $y = 2x +1$ of $Y$. So we can find the PMF for $Y$ by keeping the same probabilities as for $X$, but changing the values $x$ to the values $y = 2x +1$.

| $y$ | $5$ | $7$ | $9$ | $\cdots$ | $23$ | $25$ |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| $p_Y(y)$ | $\frac{1}{36}$ | $\frac{2}{36}$ | $\frac{3}{36}$ | $\cdots$ | $\frac{2}{36}$ | $\frac{1}{36}$ |
:::

::: {.example}
What about $Z = (X - 4)^2$? This is a bit trickier, because more than one outcome $x$ can lead to the same outcome $z = (x - 4)^2$: for example, $(2 - 4)^2 = (6 - 4)^2 = 4$. So, more precisely, we have
  \[ \mathbb P(Z = z) = \mathbb P\big(X \in \{x : (x - 4)^2 = z\}\big) , \]
or, in terms of PMFs,
  \[   p_Z(z) = \sum_{x : (x - 4)^2 = z} p_X(x) . \]
  
| $z$ | $0$ | $1$ | $4$ | $\cdots$ | $49$ | $64$ |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| $p_Z(z)$ | $\frac{3}{36}$ | $\frac{2}{36} + \frac{4}{36} = \frac{6}{36}$ | $\frac{1}{36} + \frac{5}{36} = \frac{6}{36}$ | $\cdots$ | $\frac{2}{36}$ | $\frac{1}{36}$ |
:::
-->

<!--
## Discrete uniform distribution  {#discrete-uniform}

As a sort of equivalent to the classical probability we saw in [Section 3](#S03-classical), we can consider a random variable that also takes finitely many values with equal probability. 

Let $X$ take the values $\{1,2,\dots,n\}$ each with equal probability $1/n$. This is called the **discrete uniform distribution** on $\{1,2,\dots,n\}$.

Then the PMF of $X$ is
\[ p(x) = \frac 1n \qquad \text{for $x \in \{1,2,\dots, n\}$.} \]
The CDF of $X$ is
\[ F(x) = \begin{cases} 0 & \text{for $x < 1$,} \\
              \displaystyle\frac in & \text{if $i \leq x < i+1$ for some $i \in \{1,2,\dots,n-1\}$,} \\
              1 & \text{for $x \geq n$.} \end{cases} \]
              
The expectation of $X$ is
\begin{align*}
\mathbb EX &= 1\times\frac1n + 2\times\frac1n + \cdots n \times \frac1n \\
  &= \frac 1n (1 + 2 + \cdots + n) \\
  &= \frac 1n \cdot \frac{n(n+1)}{2} \\
  &= \frac{n+1}{2} .
\end{align*}

To variance of $X$, we first calculate $\mathbb EX^2$ as
\begin{align*}
\mathbb EX^2 &= 1^2\times\frac1n + 2^2\times\frac1n + \cdots n^2 \times \frac1n \\
  &= \frac 1n (1^2 + 2^2 + \cdots + n^2) \\
  &= \frac 1n \cdot \frac{n(n+1)(2n + 1)}{6} \\
  &= \frac{(n+1)(2n+1)}{6} .
\end{align*}
Hence,
\begin{align*}
  \Var(X) &= \mathbb EX^2 - \mu^2 \\
    &= \frac{(n+1)(2n+1)}{6} - \left( \frac{n+1}{2}\right)^2 \\
    &= \frac{(n+1)(2n+1)}{6} - \frac{(n+1)^2}{4} \\
    &= \frac{2(n+1)(2n+1) - 3(n+1)^2}{12} \\
    &= \frac{4n^2 + 6n + 2 - 3n^2 - 6n - 3}{12} \\
    &= \frac{n^2 - 1}{12} .
\end{align*}

(In the example calculations, we used the facts
\[  \sum_{i=1}^n i = \frac{n(n+1)}{2} \qquad \sum_{i=1}^n i^2 = \frac{n(n+1)(2n+1)}{6} .   \]
You are not expected to know or memorise these for an exam.)
-->

<!--chapter:end:sections/L10-expectation.Rmd-->

# Problem Sheet 3  {#P3 .unnumbered}




<style>
.myanswers { 
display: none !important;
}
</style>



\commfalse
<!--
::: {.mysummary}
[Full **solutions to non-assessed questions**](#P3-solutions) are now available.
:::

::: {.mysummary}
[The **mid-semester check-in** survey](https://forms.office.com/Pages/ResponsePage.aspx?id=qO3qvR3IzkWGPlIypTW3ywARQdZlKXRHsLcXi_ngX8NUNkoxWUlTSTBXQUVSUThGU0pXOTMwTjA0UC4u) is still open.
:::

::: {.mysummary}
You can [download this problem sheet as a PDF file](P3-sheet.pdf)
:::
-->
::: {.mysummary}
This is Problem Sheet 3. This problem sheet covers material from Lectures 7 to 10. You should work through all the questions on this problem sheet in preparation for your tutorial in Week 6. The problem sheet contains two assessed questions, which are due in by **Monday 13 November**.
:::

## A: Short questions {#P3-short .unnumbered}

```{r, child = "problems/questions/P3-short.Rmd"}
```

## B: Long questions {#P3-long .unnumbered}

```{r, child = "problems/questions/P3-long.Rmd"}
```


## C: Assessed questions {#P3-assessed .unnumbered}

::: {.mysummary}
The last two questions are **assessed questions**. These two questions count for 3% of your final mark for this module.

The deadline for submitting your solutions is **2pm on Monday 14 November** at the beginning of Week 7. Submission is via Gradescope.
Your work will be marked by your tutor and returned on Monday 21 November, when solutions will also be made available.

Both questions are "long questions", where the marks are not only for mathematical accuracy but also for the clarity and completeness of your explanations. 

You should not collaborate with others on the assessed questions: your answers must represent solely your own work. The University's rules on [academic integrity](https://library.leeds.ac.uk/info/1401/academic_skills/46/academic_integrity_and_plagiarism) -- and the related punishments for violating them -- apply to your work on the assessed questions.
:::

```{r, child = "problems/questions/P3-assessed.Rmd"}
```

## Solutions to short questions {#P3-short-sols .unnumbered}

**A1.** (c) and (e) are independent.  
**A2.**  (a) Yes (b) Yes (c) No  
**A3.** 0.45 and 0.5725  
**A4.** $a = 9, b = 0.5$  
**A5** (a) 66.2 °F (b) 33.7 °F^2^




<!--chapter:end:problems/P3.Rmd-->

# (PART\*) Other stuff  {-}

# R Worksheets {#R .unnumbered}

<!--
## About R and RStudio  {#about-r .unnumbered}

* **R** is a *programming language* that is particularly useful for working with probability and statistics. The R language is very widely used in universities and increasingly widely used in industry. Learning to use R is a mandatory part of this module, and exercises requiring use of R make up at least 15% of your module mark. Many other statistics-related modules at the University also use R.
* **RStudio** is a *program* (or *app*) that gives a convenient way to work with the language R. The RStudio program is made by the company Posit. RStudio is the most common way to use the language R, and learning to use RStudio is strongly recommended.

R and RStudio are free/open-source software.

There are a number ways you can use R and RStudio:

1. *On University computers.* You will learn how to use R and RStudio on University computers in your first practical session, in Week 2.
2. *On your own computer.* R and RStudio can easily be installed on Windows and Mac laptops (and on Intel-based Chromebooks with considerable difficulty). Bring your laptop along to the first practical session to learn how to install R and RStudio.
3. *Using the Posit Cloud.* The Posit Cloud is a way to use R and RStudio online -- sort of like a "Google Docs for R". You can use it free for 25 hours a month, which should be plenty for this module, or pay for more. I recommend the Posit Cloud for using R/RStudio with Chromebooks, tablet computers, or when borrowing someone else's device.


## R practical sessions {#r-practicals .unnumbered}

We will introduce you to R and RStudio in your first practical session, in Week 2. We will first show you how to use R on University computers (these sessions will take place in computer "clusters"). There will then be an opportunity to install R on your own device -- if you have a laptop on which you want to install R, bring it along to the practical session.

A second practical, in Week 3, will allow you to get help on the R Worksheet 2, which is the first worksheet with assessed questions.


## R worksheets  {#r-work .unnumbered}

-->

Each week (starting in Week 2) there will be an R worksheet to work through in your own time. I recommend spending about one hour on each worksheet, plus one extra hour for even-numbered worksheets with assessed questions, for checking and submitting your solutions.

| Week | Worksheet                    | Solutions | Deadline for assessed work |
|:----:|------------------------------|:---------:|:--------------------------:|
|   2  | [**1: R basics**](R1.html)   | [Solutions](R1-solutions.html) |  ---  |
|   3  | [**2: Vectors**](R2.html)    | [Solutions](R2-solutions.html) | Monday 23 October |
|   4  | [**3: Data in R**](R3.html)  |           |  ---                       |

<!--
| Week | Worksheet                     | Deadline for assessed work |
|:----:|-------------------------------|:--------------------------:|
|   1  |  [**R basics**](https://mpaldridge.github.io/math1710/R1.html) ([Solutions](https://mpaldridge.github.io/math1710/R1-solutions.html)) | --- |
|   2  |  [**Vectors**](https://mpaldridge.github.io/math1710/R2.html)   | --- |
|   3  |  [**Data in R**](https://mpaldridge.github.io/math1710/R3.html)  | Monday 24 October (Week 4) |
|   4  |  [**Plots I:** Making plots](https://mpaldridge.github.io/math1710/R4.html)   | --- |
|   5  |  [**Plots II:** Making plots better](https://mpaldridge.github.io/math1710/R5.html)  | Monday 7 November (Week 6) |
|   6  |  [**RMarkdown** (optional)](https://mpaldridge.github.io/math1710/R6.html) [[Rmd](https://mpaldridge.github.io/math1710/R6.Rmd)] | --- |
|   7  |  [**Discrete distributions**](https://mpaldridge.github.io/math1710/R7.html) [[Rmd](https://mpaldridge.github.io/math1710/R7.Rmd)]    |      Monday 21 November (Week 8)   |
|   8  |  [**Discrete random variables**](https://mpaldridge.github.io/math1710/R8.html) [[Rmd](https://mpaldridge.github.io/math1710/R8.Rmd)] | --- |
|   9  |  [**Normal distribution**](https://mpaldridge.github.io/math1710/R9.html) [[Rmd](https://mpaldridge.github.io/math1710/R9.Rmd)] | Monday 5 December (Week 10) |
|  10  |  [**Law of large numbers**](https://mpaldridge.github.io/math1710/R10.html) [[Rmd](https://mpaldridge.github.io/math1710/R10.Rmd)] |             ---           |
|  11  |  [**Recap**](https://mpaldridge.github.io/math1710/R11.html) | Thursday 15 December (Week 11) |
-->
<!--
|   2  |  [**Vectors**](https://mpaldridge.github.io/math1710/R2.html)   | --- |
|   3  |  [**Data in R**](https://mpaldridge.github.io/math1710/R3.html) | Monday 18 October |
|   4  |  [**Plots I:** Making plots](https://mpaldridge.github.io/math1710/R4.html) | --- |
|   5  |  [**Plots II:** Making plots better](https://mpaldridge.github.io/math1710/R5.html) | Monday 1 November |
|   6  |  [**RMarkdown** (optional)](https://mpaldridge.github.io/math1710/R6.html) [[Rmd](https://mpaldridge.github.io/math1710/R6.Rmd)] | --- |
|   7  |  [**Discrete distributions**](https://mpaldridge.github.io/math1710/R7.html) [[Rmd](https://mpaldridge.github.io/math1710/R7.Rmd)]      |      Monday 15 November    |
|   8  |  [**Discrete random variables**](https://mpaldridge.github.io/math1710/R8.html) [[Rmd](https://mpaldridge.github.io/math1710/R8.Rmd)] | --- |
|   9  |  [**Normal distribution**](https://mpaldridge.github.io/math1710/R9.html) | Monday 29 November |
|  10  |  ~~Law of large numbers~~     |             ---           |
|  11  |   [**Recap**](https://mpaldridge.github.io/math1710/R11.html) | Thursday 16 December |
-->


<!--

## How to access R and RStudio  {#r-access .unnumbered}

There are a few ways you can access R and RStudio.

First, you can **install R and RStudio on your own computer**. Students who have their own computer (with administration and installation rights) usually find this the most convenient way use R.

When you install R and RStudio, it's important that you install R (the programming language) first, and only install RStudio (the program to use R) after R has already been installed. This ensures that RStudio can "find" R on your computer.

1. *First*, install R. Go to the [Comprehensive R Archive Network (CRAN)](https://cran.r-project.org/) and follow the instructions:

   * Windows: Click ["Download R for Windows"](https://cran.r-project.org/bin/windows/), then ["Install R for the first time"](https://cran.r-project.org/bin/windows/base/). The main link at the top should be to download the most recent version of R.
   * Mac: Click [Download R for macOS](https://cran.r-project.org/bin/macosx/), and then download the relevant PKG file. (For typically older Intel-based Macbooks, you must use the "Intel 64-bit build"; for post-November 2020 M1 or M2-based "Apple silicon" Macbooks, the "Apple silicon arm64 build" may be slightly faster.)
2. *After* R is installed, *then* install RStudio. Go to [the Download page at RStudio.com](https://www.rstudio.com/products/rstudio/download/#download) and follow the instructions. You want "RStudio Desktop", and you want the free version.

If you have difficulty installing R, come along to the R troubleshooting drop-in session in Week 2 and bring your computer with you (if it's sufficiently portable), and we'll do our best to help.

Second, you can **use R and RStudio on University computers**. All University computers have access to R and RStudio, via the AppsAnywhere service. *First*, launch R via AppsAnywhere (at the time of writing, it's confusingly named "Cran R 4.2.0 x64"). You can then close the program that opens. *Then* launch RStudio ("Rstudio 2022"), also via AppsAnywhere. (You can decline any updates that are suggested.)

The R drop-in sessions take place in computer rooms, so if you have problems accessing R and RStudio on University computers, you can get help at the drop-in sessions too.

Third, you can **use the [RStudio Cloud](https://rstudio.cloud/)**. The RStudio Cloud is a cloud-hosted "Google Docs for R" that you can use through your web browser, without having to install anything. You can get 25 hours per month for free, which should be plenty for this module, or pay for more.

If you have access to a computer on which you can't install software, such as some Chromebooks or tablet computers, or if you're borrowing a friend's laptop, the RStudio Cloud can be a convenient solution. 

*Update:* If you have an Intel-based Chromebook, then we have had success installing R and RStudio using [these (rather complicated) instructions](https://levente.littvay.hu/chromebook/), although you may still find it more convenient just to use the RStudio Cloud.



## R troubleshooting drop-in sessions  {#troubleshooting .unnumbered}

You will learn to use R by working through the R Worksheets. Learning to use a programming language is different from learning mathematics: you should expect to regularly get frustrated and annoyed when the computer seems to refuse to do what you want it to (but also occasionally experience the joy of getting it right!). This is a normal part of learning.

However, many students find getting with started with R in the first few weeks particularly difficult. Also, sometimes students have problems installing R and RStudio on their own computers. To help with this, we have organised optional R troubleshooting drop-in sessions in Weeks 2 and 3. Check your timetable for details -- they are probably listed as "computer practicals".

-->




<!--chapter:end:R/R.Rmd-->

# R Practical 1 {#practical .unnumbered}

::: {.mysummary}
[**R Worksheet 1** is here](R1.html)
:::


## About the Practical  {#about-prac .unnumbered}

The first computer practical sessions are this week to introduce you to the R programming language. You should make sure:

* You know [where](#directions) and when your practical session is -- check your timetable!
* You know your username, password, and the Duo authentication system to log on to university computers.
* To bring your laptop along if (optionally) you want to install R and RStudio on it.

[Below are some directions](#directions) of how to find the various computer clusters.


## What are R and RStudio?  {#what-is-r .unnumbered}

* **R** is a *programming language* that is particularly useful for working with probability and statistics. The R language is very widely used in universities and increasingly widely used in industry. Learning to use R is a mandatory part of this module, and exercises requiring use of R make up at least 15% of your module mark. Many other statistics-related modules at the University also use R.
* **RStudio** is a *computer program* (or *app*) that gives a convenient way to work with the language R. The RStudio program is made by the company Posit. THe program RStudio is the most common way to use the language R, and learning to use RStudio is strongly recommended.

R and RStudio are free/open-source software.

There are a number ways you can use R and RStudio:

1. *On University computers.* You will learn how to use R and RStudio on University computers in your first practical session, in Week 2.
2. *On your own computer.* R and RStudio can easily be installed on Windows and Mac laptops. Bring your laptop along to the first practical session to learn how to install R and RStudio.
3. *Using the [Posit Cloud](https://posit.cloud).* The [Posit Cloud](https://posit.cloud) is a way to use R and RStudio online -- sort of like a "Google Docs for R". You can use it free for 25 hours a month, which should be plenty for this module, or pay for more. I recommend the Posit Cloud for using R/RStudio with Chromebooks, tablet computers, or when borrowing someone else's device.

## Accessing R and RStudio on University computers  {#r-uni .unnumbered}

R and RStudio can be used on University computers via the AppsAnywhere portal. AppsAnywhere is the University of Leeds system for loading "unusual" programs (common programs like Microsoft Office and web browsers are preloaded).

There are three steps to using R and RStudio on University computers:

1. Open the AppsAnywhere portal.
2. Load the language R onto your computer.
3. Open the program RStudio.

First, open the AppsAnywhere portal by double-clicking on the desktop icon. This will open a web browser, and invite you to "Open AppsAnywhere Launcher" -- you should accept and open. AppsAnywhere has loaded properly when the blue "Validation in progress..." box turns into a green "Validation Successful" box.

Second, launch R from AppsAnywhere. R is called "Cran R 4.2.0 x64" on AppsAnywhere, so searching for "Cran" is an easy way to find it. Click "Launch".

This will do two things. First, it will silently load the language R in the background. Second, it will open a program called "RGui". RGui is basically like an older and less good version of RStudio; we do not recommend using the RGui program, so you can close it. (The R language will remain loaded.)

Third, launch RStudio from AppsAnywhere. The most recent version on AppsAnywhere is "RStudio 2023 (03.0.386)". Click "Launch". After a few second, RStudio will launch. (If invited to choose a version of the language R, pick "64-bit". If invited to update R or RStudio, decline.)

You need to repeat all three steps each time you log onto a University computer.


## Installing R and RStudio  {#r-install .unnumbered}

When you install R and RStudio, it's important that you install the language R first, and only install the program RStudio after the language R has already been installed. This ensures that RStudio can "find" R on your computer.

1. *First*, install R. Go to the [Comprehensive R Archive Network (CRAN)](https://cran.r-project.org/) and follow the instructions:

   * Windows: Click ["Download R for Windows"](https://cran.r-project.org/bin/windows/), then ["Install R for the first time"](https://cran.r-project.org/bin/windows/base/). The main link at the top should be to download the most recent version of R.
   * Mac: Click [Download R for macOS](https://cran.r-project.org/bin/macosx/), and then download the relevant PKG file. (Most modern Macbooks are based on Apple's M1 or M2 processors, so you can choose "Apple silicon arm64 build". Some older Macbooks, mostly 2020 or earlier, have Intel processors; for these you should use the "Intel 64-bit build".)
   
2. *After* R is installed, *then* install RStudio. Go to the ["Download RStudio" page at posit.co](https://posit.co/download/rstudio-desktop/) and follow the instructions. You want "RStudio Desktop" and you want the free version, if given a choice.

Now, whenever you want to use R and RStudio, simply open program RStudio. (The language R will automatically be loaded on your computer.)

For Chromebooks, we recommend using the [Posit Cloud](https://posit.cloud), as mentioned above. However, if you have an Intel-based Chromebook and are feeling brave, then we have had success installing R and RStudio using [these instructions](https://levente.littvay.hu/chromebook/), which are long and complicated.


## Where are the computer clusters?  {#directions .unnumbered}

### EC Stoner Cluster 6.68  {#stoner .unnumbered}

[**EC Stoner Cluster 6.68** [map]](ecstoner.png) is in the **EC Stoner building**. The easiest way to enter the 6th floor of EC Stoner is via the sliding doors ("South Entrance 4") opposite the multi-storey car park ([red arrow](ecstoner.png)).

Alternatively, from the "red route" along the 10th floor corridor of EC Stoner, go all the way along to the School of Food Science and Nutrition, by staircase 4, and take the lift (*not* the stairs) to the 6th floor ([blue dotted line](ecstoner.png)).

EC Stoner Cluster 6.68 is the big room to the east (right from the doors; left from the lift), through the smaller ante-room.

### Fourman O & P Clusters  {#fourman .unnumbered}

The [**Fourman O & P Clusters** [map]](fourman.png) are in the **Worsley building**, at the south of campus. The easiest route is from Chancellor's Court, next to the Roger Stevens building: follow the North--South Access Route alongside and then through the Garstang building, and enter the Worsley building at the 7th floor "airport lounge" area ([red arrow](fourman.png)). Follow the signs to "Central Teaching Space": turn left to get to the East staircase, and go up one floor the the 8th floor.

Alternatively, enter the Worsley building on Clarendon Way at the 4th floor ([blue arrow](fourman.png)). The East lifts are to your left: take the lift to the 8th floor.

On the 8th floor of the Worsley building, the Fourman Clusters are two connected rooms right next the East staircase/lifts – Fourman O is on the right; Fourman P is on the left.

### Irene Manton North & South Clusters  {#manton .unnumbered}

The [**Irene Manton Clusters** [map]](manton.png) are in the **Irene Manton building**, which is behind the Roger Stevens building. You can get there out the back door of Roger Stevens, by LT 01, or via the gardens to the right of Roger Stevens.

Walking down the walkway alongside the Irene Manton building, there's a modest, unassuming door on your left. Enter it. Irene Manton North is the room to your left; Irene Manton South is to your right.

### Psychology Cluster 1.43  {#psychology .unnumbered}

[**Psychology Cluster 1.43** [map]](psychology.png) is in the **Psychology building**, which is in between the two main east–west thoroughfares through campus -- University Road and Beach Grove Terrace/Precinct/Lifton Place. One entrance to Psychology is on Lifton Place, opposite Cromer Street, up some steps; the other is on University Road, opposite the School of Fine Art, through a little garden.

Once inside Psychology, there are signs to the "CBL clusters". Follow a long winding corridor to the east (right from Lifton Place entrance; left from University Road entrance), past a giant glittery brain sculpture, all the way to a spiral staircase. Go up one floor. Psychology Cluster 1.43 is the room on the right.

### Richard Hughes Cluster  {#hughes .unnumbered}

The [**Richard Hughes Cluster** [map]](richard-hughes.png) is on the side of the **Clothworkers' Link building**, on the north side of University Road by the "Clothworkers' Link" -- the sky-bridge that goes over University Road.

Just to the west (Hyde Park side) of the Link bridge, go up the alleyway between the Clothworkers' Link building and 28 University Road. Enter a small door on the right; the Richard Hughes Cluster is at the top of a short flight of stairs to your left.

<!--chapter:end:R/practical.Rmd-->

\commtrue



# Solutions and group feedback {#solutions .unnumbered}

::: {.mysummary}
This page has the solutions to all the non-assessed questions on Problem Sheet 1. Solutions are added after all tutorials on a Problem Sheet have finished.

Solutions to assessed questions are available on Minerva in the "Assessments" tab, from one week after the deadline.

There are many ways you get feedback on this module, both group feedback (feedback that is generally relevant to many people) and individual feedback (feedback based specifically on your own approach to the work).

* You will have received both individual and group spoken feedback in your tutorial (the more you speak up in your tutorial, the more individualised the feedback you get in return).

* These solutions include group written feedback on common issues for the class.

* Most importantly, when your work on assessed questions is marked, individual written feedback will be given via the Gradescope site. It is very important that you read that feedback.

* Finally, students who would like even more feedback can discuss their work with me in the "office hours" drop-in sessions.
:::

## Problem Sheet 1 {#P1-solutions .unnumbered}

### A: Short questions {#P1-short-solutions .unnumbered}

```{r, child = "problems/questions/P1-short.Rmd"}
```

### B: Long questions {#P1-long-solutions .unnumbered}

```{r, child = "problems/questions/P1-long.Rmd"}
```

<!--chapter:end:problems/solutions.Rmd-->

